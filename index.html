<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RBI FIELD | SEC JERICK</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png">
    <meta name="theme-color" content="#0f172a">
    <meta name="application-name" content="RBI FIELD">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

    <style>
        /* --- MODERN DESIGN VARIABLES --- */
        :root {
            --primary: #0f172a;
            --accent: #3b82f6;
            --accent-hover: #2563eb;
            --bg: #f1f5f9;
            --card: #ffffff;
            --text-main: #334155;
            --text-light: #64748b;
            --danger: #ef4444;
            --success: #22c55e;
            --warning: #f59e0b;
            --male: #3b82f6;
            --female: #ec4899;
        }

        *, *::before, *::after { box-sizing: border-box; }
        html, body { margin: 0; padding: 0; height: 100%; overflow-x: hidden; }
        body { font-family: 'Inter', 'Segoe UI', sans-serif; background: var(--bg); color: var(--text-main); -webkit-tap-highlight-color: transparent; }

        .context-bar {
            background: var(--primary);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            position: sticky; top: 0; z-index: 900;
            height: 70px; 
        }
        
        .purok-selector-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
            display: flex; align-items: center; gap: 8px;
            max-width: 200px;
        }
        .purok-selector-btn:active { background: rgba(255,255,255,0.2); transform: scale(0.98); }
        .purok-badge { background: var(--warning); color: #000; padding: 2px 6px; border-radius: 10px; font-weight: 800; font-size: 11px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100px; }

        .app-container { 
            max-width: 600px; 
            margin: 0 auto; 
            padding-bottom: 20px; 
            min-height: 100vh; 
            position: relative; 
            display: flex; 
            flex-direction: column; 
        }

        .tab-nav { 
            display: flex; 
            background: white; 
            border-bottom: 1px solid #e2e8f0; 
            position: sticky; 
            top: 70px; 
            z-index: 800; 
            overflow-x: auto; 
            white-space: nowrap;
            -webkit-overflow-scrolling: touch; 
            scrollbar-width: none; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
            padding-right: 20px; 
        }
        .tab-nav::-webkit-scrollbar { display: none; }

        .tab-btn {
            flex: 1 0 auto; 
            border: none; background: none; 
            padding: 16px 15px; 
            font-size: 11px; font-weight: 700; color: var(--text-light);
            cursor: pointer; border-bottom: 3px solid transparent; 
            transition: 0.2s; white-space: nowrap;
            text-align: center;
            min-width: 70px; 
            letter-spacing: 0.5px;
        }
        .tab-btn.active { color: var(--accent); border-bottom-color: var(--accent); }

        .content-area { padding: 20px; display: none; opacity: 0; transition: transform 0.3s ease, opacity 0.3s ease; flex: 1; }
        .content-area.active { display: block; opacity: 1; }
        
        .slide-in-right { animation: slideInRight 0.3s forwards; }
        .slide-in-left { animation: slideInLeft 0.3s forwards; }
        
        @keyframes slideInRight { from { transform: translateX(50px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes slideInLeft { from { transform: translateX(-50px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        .card-section {
            background: var(--card); padding: 20px; border-radius: 12px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); margin-bottom: 20px;
            border: 1px solid #f1f5f9;
        }
        .section-title {
            color: var(--primary); font-size: 13px; font-weight: 800;
            border-left: 4px solid var(--accent); padding-left: 12px; margin: 0 0 20px 0;
            text-transform: uppercase; letter-spacing: 0.5px;
        }

        .form-group { margin-bottom: 18px; }
        label { display: block; font-size: 11px; font-weight: 700; color: var(--text-light); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.8px; }
        .req { color: var(--danger); margin-left: 2px; }

        input, select {
            width: 100%; padding: 14px 16px;
            border-radius: 10px; border: 1px solid #e2e8f0;
            font-size: 14px; background: #f8fafc; color: #1e293b;
            transition: all 0.2s; text-transform: uppercase;
            font-weight: 500;
        }
        input:focus, select:focus { border-color: var(--accent); background: white; outline: none; box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1); }

        select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            padding-right: 40px;
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%233b82f6%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 10px;
        }

        .btn {
            width: 100%; padding: 16px; border-radius: 12px; border: none;
            font-size: 13px; font-weight: 800; cursor: pointer;
            display: flex; align-items: center; justify-content: center; gap: 10px;
            text-transform: uppercase; letter-spacing: 1px; transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.98); }
        .btn-primary { background: var(--accent); color: white; box-shadow: 0 10px 20px -10px rgba(59, 130, 246, 0.5); }
        .btn-success { background: var(--success); color: white; box-shadow: 0 10px 20px -10px rgba(34, 197, 94, 0.5); }
        .btn-danger { background: var(--danger); color: white; }
        .btn-ghost { background: #e2e8f0; color: var(--text-main); }
        .btn-small { width: auto; padding: 8px 16px; font-size: 11px; }

        .sector-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 15px; }
        .toggle-card {
            background: #fff; border: 1px solid #e2e8f0; padding: 15px;
            border-radius: 10px; display: flex; align-items: center; justify-content: space-between;
            transition: 0.2s;
        }
        .toggle-card:hover { border-color: var(--accent); }
        input[type="checkbox"] { width: 20px; height: 20px; accent-color: var(--accent); margin: 0; }

        #toast-container {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            z-index: 100000; 
            display: flex; flex-direction: column; gap: 10px; align-items: center;
            width: 90%; max-width: 400px;
        }
        .toast {
            background: #1e293b; color: white; padding: 14px 20px; border-radius: 12px;
            font-size: 13px; font-weight: 500;
            box-shadow: 0 10px 30px -5px rgba(0,0,0,0.3);
            animation: slideUpFade 0.3s ease-out; display: flex; align-items: center; gap: 12px; width: 100%;
        }
        .toast.success { border-left: 4px solid var(--success); }
        .toast.error { border-left: 4px solid var(--danger); }
        .toast.info { border-left: 4px solid var(--accent); }
        @keyframes slideUpFade { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(5px);
            z-index: 2000; display: none; align-items: center; justify-content: center;
        }
        .modal-box {
            background: white; width: 85%; max-width: 350px;
            border-radius: 24px; padding: 30px; text-align: center;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            animation: popIn 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-height: 90vh; overflow-y: auto;
        }
        @keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.1); width: 40px; height: 40px;
            border-radius: 50%; border-left-color: var(--accent);
            animation: spin 1s linear infinite; margin: 0 auto 15px auto;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .app-footer {
            text-align: center;
            padding: 30px 20px;
            font-size: 10px;
            font-weight: 700;
            color: var(--text-light);
            letter-spacing: 1.5px;
            margin-top: auto;
            text-transform: uppercase;
            opacity: 0.6;
        }

        .static-export-bar {
            position: sticky;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            padding: 15px 20px;
            border-top: 1px solid #e2e8f0;
            z-index: 500;
            margin: 0 -20px -20px -20px;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.05);
        }

        .record-card {
            background: white; border-radius: 10px; padding: 15px; margin-bottom: 10px;
            border: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;
            transition: 0.2s;
        }
        .record-card:active { transform: scale(0.98); background: #f8fafc; }
        .record-card h5 { margin: 0; font-size: 14px; color: var(--primary); font-weight: 700; }
        .record-card p { margin: 3px 0 0; font-size: 11px; color: var(--text-light); font-weight: 500; }
        
        .pred-list {
            list-style: none; padding: 0; margin: 0; border: 1px solid #cbd5e1; border-top: none;
            max-height: 150px; overflow-y: auto; background: white; border-radius: 0 0 10px 10px; display: none;
            text-align: left;
        }
        .pred-item { padding: 12px 15px; font-size: 13px; border-bottom: 1px solid #f1f5f9; cursor: pointer; }
        .pred-item:active { background: #f1f5f9; }

        .pagination { display: flex; justify-content: center; gap: 10px; margin-top: 25px; }
        .page-btn { padding: 8px 16px; background: white; border: 1px solid #e2e8f0; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: 600; color: var(--text-main); }
        .page-btn.disabled { opacity: 0.5; cursor: not-allowed; }
        
        .config-item { display: flex; justify-content: space-between; padding: 12px; border-bottom: 1px solid #f1f5f9; font-size: 13px; font-weight: 500; }
        
        .install-float-btn {
            position: fixed; bottom: 30px; right: 25px;
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white; padding: 14px 24px; border-radius: 50px;
            box-shadow: 0 15px 30px -8px rgba(37, 99, 235, 0.5);
            display: none; z-index: 10000; font-weight: 800; font-size: 13px;
            align-items: center; gap: 10px; cursor: pointer;
            border: 2px solid rgba(255,255,255,0.2);
            animation: bounceIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            letter-spacing: 0.5px;
        }
        @keyframes bounceIn { from { transform: scale(0); } to { transform: scale(1); } }

        .share-link {
            color: var(--accent);
            text-decoration: underline;
            font-weight: 700;
            font-size: 14px;
            cursor: pointer;
            padding: 10px;
        }
        .template-btn {
            padding: 12px; border: 1px solid #e2e8f0; border-radius: 10px;
            margin-bottom: 10px; cursor: pointer; text-align: left;
            display: flex; align-items: center; gap: 10px; background: #f8fafc;
        }
        .template-btn:hover { border-color: var(--accent); background: white; }

        .radio-group {
            display: flex; gap: 5px; margin-bottom: 15px; background: #f1f5f9; padding: 4px; border-radius: 12px;
        }
        .radio-option {
            flex: 1; text-align: center; padding: 8px; font-size: 11px; font-weight: 700; 
            border-radius: 8px; cursor: pointer; color: var(--text-light); transition: 0.2s;
        }
        .radio-option.selected {
            background: white; color: var(--accent); box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
    </style>
</head>
<body>

<button id="install-btn" class="install-float-btn">
    <i class="fas fa-download"></i> INSTALL APP
</button>

<div id="toast-container"></div>

<div id="login-overlay" class="modal-overlay" style="display:flex; z-index:99990;">
    <div class="modal-box">
        <div style="color:var(--primary); font-size:48px; margin-bottom:15px;"><i class="fas fa-shield-alt"></i></div>
        <h3 style="margin:0; color:var(--primary); font-weight:800; letter-spacing:1px;">SECURITY CHECK</h3>
        <p style="font-size:12px; color:#64748b; margin-bottom:25px; line-height:1.5;" id="login-msg">Enter System Password to Access</p>
        <input type="password" id="login-pass" style="text-align:center; margin-bottom:20px; font-size:16px; letter-spacing:2px;" placeholder="• • • •">
        <button class="btn btn-primary" onclick="attemptLogin()">UNLOCK SYSTEM</button>
        <div style="margin-top:20px; font-size:11px; cursor:pointer; color:var(--accent); font-weight:600;" onclick="forgotPassword()">Reset Password</div>
    </div>
</div>

<div id="loading-modal" class="modal-overlay" style="z-index:99998;">
    <div class="modal-box">
        <div class="spinner"></div>
        <h3 id="loading-title" style="margin:0; color:var(--primary);">PROCESSING...</h3>
        <p id="loading-desc" style="font-size:13px; color:#666; margin: 10px 0 0 0;">Please wait.</p>
    </div>
</div>

<div id="export-options-modal" class="modal-overlay" style="z-index:99995;">
    <div class="modal-box">
        <h3 style="margin:0 0 15px 0;">CHOOSE TEMPLATE</h3>
        <p style="font-size:12px; color:#666; margin-bottom:20px;">Select the export format:</p>
        
        <div class="template-btn" onclick="processExport('BIMS')">
            <i class="fas fa-file-invoice" style="color:var(--warning);"></i>
            <div>
                <div style="font-weight:700; font-size:13px;">BIMS COMPATIBLE</div>
                <div style="font-size:10px; color:#64748b;">Gov't Format — exact Import_Inhabitant_Template v1.4.2. <span style="color:var(--success);">✓ Strictly formatted for BIMS import.</span></div>
            </div>
        </div>

        <div class="template-btn" onclick="processExport('RBIS')">
            <i class="fas fa-database" style="color:var(--accent);"></i>
            <div>
                <div style="font-weight:700; font-size:13px;">RBIS FULL DATA</div>
                <div style="font-size:10px; color:#64748b;">Exports all system columns including Purok &amp; Sectors.</div>
            </div>
        </div>

        <div class="template-btn" onclick="processExport('BOTH')">
            <i class="fas fa-copy" style="color:var(--success);"></i>
            <div>
                <div style="font-weight:700; font-size:13px;">DOWNLOAD BOTH</div>
                <div style="font-size:10px; color:#64748b;">Get both BIMS and RBIS files.</div>
            </div>
        </div>

        <button class="btn btn-ghost" onclick="closeExportModal()" style="margin-top:10px;">CANCEL</button>
    </div>
</div>

<div id="share-modal" class="modal-overlay" style="z-index:99996;">
    <div class="modal-box">
        <div style="color:var(--success); font-size:50px; margin-bottom:15px;"><i class="fas fa-check-circle"></i></div>
        <h3 style="margin:0;">FILE READY</h3>
        <p style="font-size:13px; color:#666; margin: 10px 0 20px 0;">File generated successfully.</p>
        
        <button id="btn-smart-share" class="btn btn-primary" onclick="triggerSmartAction()" style="margin-bottom:12px; padding: 18px;">
            <i class="fas fa-share-alt" style="font-size:16px;"></i> SHARE VIA APP
        </button>

        <button class="btn btn-ghost" onclick="downloadDirectly()" style="border:1px solid #cbd5e1;">
            <i class="fas fa-download"></i> SAVE TO DEVICE
        </button>

        <div id="share-fallback-info" style="display:none; color:var(--text-light); font-size:11px; margin-top:15px; padding:10px; background:#f1f5f9; border-radius:8px; border-left:3px solid var(--warning);">
            <i class="fas fa-info-circle"></i> <b>Note:</b> If "Share via App" doesn't work, please use "Save to Device".
        </div>
        
        <div id="protocol-warning" style="display:none; margin-top:15px; padding:10px; background:#fef2f2; border-left:3px solid var(--danger); border-radius:6px; font-size:11px; text-align:left; color:#991b1b;">
            <i class="fas fa-exclamation-circle"></i> <b>Offline Mode:</b> Share disabled. Please Save.
        </div>

        <div style="margin-top:20px; font-size:12px; color:#94a3b8; cursor:pointer; text-decoration:underline;" onclick="closeShareModal()">Close</div>
    </div>
</div>

<style> @keyframes fadeIn { from { opacity:0; } to { opacity:1; } } </style>

<div id="location-settings-modal" class="modal-overlay" style="z-index:99999;">
    <div class="modal-box">
        <h3 style="margin:0; color:var(--primary); margin-bottom:15px;">LOCATION CONTEXT</h3>
        
        <label style="text-align:left;">Indicator Type</label>
        <div class="radio-group">
            <div class="radio-option selected" id="opt-type-purok" onclick="selectLocType('PUROK')">PUROK</div>
            <div class="radio-option" id="opt-type-sitio" onclick="selectLocType('SITIO')">SITIO</div>
            <div class="radio-option" id="opt-type-none" onclick="selectLocType('NONE')">NONE</div>
        </div>

        <label style="text-align:left;" id="lbl-naming">Naming Convention</label>
        <div class="radio-group" id="group-naming">
            <div class="radio-option selected" id="opt-name-num" onclick="selectLocName('NUMBER')">NUMBER</div>
            <div class="radio-option" id="opt-name-txt" onclick="selectLocName('NAME')">NAME</div>
        </div>

        <label style="text-align:left; margin-top:10px;" id="lbl-input">Value</label>
        <input id="loc-input-val" type="text" style="text-align:center; margin-bottom:20px; font-size:16px;">

        <div style="display:flex; gap:10px;">
            <button class="btn btn-ghost" onclick="closeLocationModal()">CANCEL</button>
            <button class="btn btn-primary" onclick="saveLocationSettings()">APPLY</button>
        </div>
    </div>
</div>

<div id="custom-prompt-modal" class="modal-overlay" style="z-index:99999;">
    <div class="modal-box">
        <h3 id="prompt-title" style="margin:0; color:var(--primary);">INPUT</h3>
        <p id="prompt-msg" style="font-size:13px; color:#666; margin: 10px 0 20px 0;"></p>
        <input id="prompt-input" type="text" style="text-align:center; margin-bottom:20px; font-size:16px;">
        <div style="display:flex; gap:10px;">
            <button class="btn btn-ghost" onclick="closePromptModal()">CANCEL</button>
            <button class="btn btn-primary" onclick="submitPromptModal()">CONFIRM</button>
        </div>
    </div>
</div>

<div id="custom-confirm-modal" class="modal-overlay" style="z-index:99997;">
    <div class="modal-box">
        <div style="color:var(--warning); font-size:40px; margin-bottom:10px;"><i class="fas fa-exclamation-triangle"></i></div>
        <h3 id="confirm-title" style="margin:0;">CONFIRM ACTION</h3>
        <p id="confirm-msg" style="font-size:13px; color:#666; margin: 10px 0 25px 0;"></p>
        <div style="display:flex; gap:10px;">
            <button class="btn btn-ghost" onclick="closeConfirmModal()">CANCEL</button>
            <button class="btn btn-primary" onclick="executeConfirmAction()">CONFIRM</button>
        </div>
    </div>
</div>

<div id="hh-modal" class="modal-overlay">
    <div class="modal-box" style="width: 95%; max-width: 450px;">
        <h4 style="margin-top:0; color:var(--primary); border-bottom:1px solid #eee; padding-bottom:15px; font-weight:800;">HOUSEHOLD MANAGER</h4>
        
        <div class="form-group" style="text-align:left;">
            <label>Household Number / ID</label>
            <input id="hh-id-input" placeholder="e.g., 2024-001">
        </div>

        <div style="text-align:left; margin-bottom:20px;">
            <label>Add Members (Search)</label>
            <input id="hh-member-search" oninput="searchMemberForHH()" placeholder="Type Name...">
            <ul id="hh-pred-list" class="pred-list"></ul>
        </div>

        <div style="text-align:left;">
            <label>Current Members &amp; Roles:</label>
            <div id="hh-members-display" style="border:1px solid #e2e8f0; padding:15px; border-radius:12px; max-height:200px; overflow-y:auto; background:#f8fafc; min-height: 100px;">
                <small style="color:#94a3b8; font-style:italic;">No members added yet.</small>
            </div>
        </div>

        <div style="display:flex; gap:10px; margin-top:25px;">
            <button class="btn btn-ghost" onclick="closeHHModal()">CLOSE</button>
            <button class="btn btn-success" onclick="saveHousehold()">SAVE HOUSEHOLD</button>
        </div>
    </div>
</div>

<div class="app-container">

    <div class="context-bar">
        <div class="context-info">
            <h4 style="margin:0; font-weight:900; letter-spacing:1px; font-size:16px;">RBI FIELD</h4>
        </div>
        <div class="purok-selector-btn" onclick="openLocationModal()">
            <span id="globalLabel">PUROK</span>
            <span class="purok-badge" id="globalPurokDisplay">1</span>
            <i class="fas fa-chevron-down" style="font-size:10px;"></i>
        </div>
    </div>

    <div class="tab-nav">
        <button class="tab-btn active" onclick="switchTab('reg')" id="btn-reg"><i class="fas fa-user-plus"></i> FORM</button>
        <button class="tab-btn" onclick="switchTab('rec')" id="btn-rec"><i class="fas fa-list"></i> RECORDS</button>
        <button class="tab-btn" onclick="switchTab('hh')" id="btn-hh"><i class="fas fa-home"></i> HOUSEHOLDS</button>
        <button class="tab-btn" onclick="switchTab('conf')" id="btn-conf"><i class="fas fa-cog"></i> SET</button>
    </div>

    <div id="tab-registration" class="content-area active">
        <div id="edit-banner" style="background:var(--warning); color:white; padding:12px; border-radius:8px; margin-bottom:20px; display:none; text-align:center; font-size:12px; font-weight:800; letter-spacing:0.5px; box-shadow:0 4px 10px rgba(245, 158, 11, 0.3);">
            <div style="margin-bottom:4px;"><i class="fas fa-edit"></i> EDITING RECORD</div>
            <div id="edit-location-msg" style="color:rgba(255,255,255,0.9);"></div>
        </div>

        <div class="card-section">
            <h5 class="section-title">1. PERSONAL DATA</h5>
            <div class="form-group">
                <label>Inhabitant Type<span class="req">*</span></label>
                <select id="inhabitantType"><option>NON-MIGRANT</option><option>MIGRANT</option><option>TRANSIENT</option></select>
            </div>
            <div class="form-group"><label>Last Name<span class="req">*</span></label><input id="lastName" placeholder="DELA CRUZ"></div>
            <div class="form-group"><label>First Name<span class="req">*</span></label><input id="firstName" placeholder="JUAN"></div>
            <div class="form-group"><label>Middle Name</label><input id="middleName" placeholder="(OPTIONAL)"></div>
            <div class="form-group"><label>Suffix</label><input id="suffix" placeholder="JR, III (OPTIONAL)"></div>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
                <div class="form-group"><label>Birthday<span class="req">*</span></label><input type="date" id="birthDate"></div>
                <div class="form-group"><label>Sex<span class="req">*</span></label><select id="sex"><option>MALE</option><option>FEMALE</option></select></div>
            </div>
            <div class="form-group"><label>Birth Place<span class="req">*</span></label><input id="birthPlace"></div>
            <!-- PATCH 1: Civil Status - Updated to match BIMS v1.4.2 template exactly -->
            <div class="form-group"><label>Civil Status<span class="req">*</span></label>
                <select id="civilStatus">
                    <option>SINGLE</option>
                    <option>MARRIED</option>
                    <option>WIDOWED</option>
                    <option>DIVORCED</option>
                    <option>SEPARATED</option>
                    <option>COMMON LAW/ LIVE-IN</option>
                    <option>UNKNOWN</option>
                    <option>ANNULLED</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Citizenship<span class="req">*</span></label>
                <select id="citizenshipSelect" onchange="checkCitizenship()">
                    <option value="FILIPINO">FILIPINO</option>
                    <option value="FOREIGNER">FOREIGNER</option>
                </select>
                <input id="citizenshipOther" placeholder="SPECIFY NATIONALITY..." style="display:none; margin-top:10px; border-color:var(--accent);">
            </div>

            <div class="form-group">
                <label>Religion (Select/Type Other)<span class="req">*</span></label>
                <select id="religionSelect" onchange="checkReligion()">
                    <option value="ROMAN CATHOLIC">ROMAN CATHOLIC</option>
                    <option value="IGLESIA NI CRISTO">IGLESIA NI CRISTO</option>
                    <option value="ISLAM">ISLAM</option>
                    <option value="EVANGELICALS">EVANGELICALS</option>
                    <option value="BAPTIST">BAPTIST</option>
                    <option value="SEVENTH DAY ADVENTIST">SEVENTH DAY ADVENTIST</option>
                    <option value="AGLIPAYAN">AGLIPAYAN</option>
                    <option value="JEHOVAH'S WITNESS">JEHOVAH'S WITNESS</option>
                    <option value="OTHERS">OTHERS (PLEASE SPECIFY)</option>
                </select>
                <input id="religionOther" placeholder="TYPE RELIGION HERE..." style="display:none; margin-top:10px; border-color:var(--accent);">
            </div>
            <div class="form-group"><label>Profession / Occupation</label><input id="profession"></div>
            
            <div class="form-group">
                <label>Labor Status</label>
                <select id="laborStatus">
                    <option value="EMPLOYED">EMPLOYED</option>
                    <option value="UNEMPLOYED">UNEMPLOYED</option>
                    <option value="NOT IN LABOR FORCE">NOT IN LABOR FORCE</option>
                </select>
            </div>
        </div>

        <div class="card-section">
            <h5 class="section-title">2. ADDRESS &amp; EDUCATION</h5>
            <div class="form-group">
                <label>Additional Address / Landmark<span class="req">*</span></label>
                <select id="addressSelect"><option value="">SELECT ADDRESS...</option></select>
                <small style="color:var(--accent); cursor:pointer; font-weight:600; margin-top:5px; display:inline-block;" onclick="switchTab('conf')"> + Manage Addresses in Set</small>
            </div>
            <div class="form-group"><label>Educational Attainment</label>
                <select id="education">
                    <option>NONE</option><option>ELEMENTARY LEVEL</option><option>ELEMENTARY GRADUATE</option>
                    <option>HIGH SCHOOL LEVEL</option><option>HIGH SCHOOL GRADUATE</option><option>SENIOR HIGH SCHOOL LEVEL</option>
                    <option>SENIOR HIGH SCHOOL GRADUATE</option><option>COLLEGE LEVEL</option><option>COLLEGE GRADUATE</option>
                    <option>VOCATIONAL</option><option>POST GRADUATE</option>
                </select>
            </div>
            <div class="form-group"><label>Contact Number</label><input id="contact" type="tel"></div>
        </div>

        <div class="card-section">
            <h5 class="section-title">3. SECTORAL MEMBERSHIP</h5>
            <div class="sector-grid">
                <div class="toggle-card"><label for="isOSY">OSY</label><input type="checkbox" id="isOSY"></div>
                <div class="toggle-card"><label for="isPWD">PWD</label><input type="checkbox" id="isPWD"></div>
                <div class="toggle-card"><label for="is4Ps">4Ps</label><input type="checkbox" id="is4Ps"></div>
                <div class="toggle-card"><label for="isIPS">IPs</label><input type="checkbox" id="isIPS"></div>
                <div class="toggle-card"><label for="isSolo">Solo Parent</label><input type="checkbox" id="isSolo"></div>
                <div class="toggle-card"><label for="isOFW">OFW</label><input type="checkbox" id="isOFW"></div>
                <div class="toggle-card"><label for="isISY">ISY</label><input type="checkbox" id="isISY"></div>
            </div>
        </div>

        <div class="card-section" style="background:#f8fafc; border:1px dashed #cbd5e1;">
            <h5 class="section-title" style="border-left-color:var(--text-light); color:var(--text-main);">4. MOTHER'S MAIDEN NAME</h5>
            <div class="form-group">
               <input id="motherSearch" list="motherList" onchange="autoFillMother(this)" placeholder="SEARCH EXISTING MOTHERS..." style="border-color:var(--accent);">
               <datalist id="motherList"></datalist>
            </div>
            <div class="form-group"><input id="mFirst" placeholder="MOTHER'S FIRST NAME"></div>
            <div class="form-group"><input id="mMiddle" placeholder="MOTHER'S MIDDLE NAME"></div>
            <div class="form-group"><input id="mLast" placeholder="MOTHER'S LAST NAME"></div>
        </div>

        <div style="display:flex; gap:15px; margin-top:30px;">
            <button id="btn-cancel" class="btn btn-danger" onclick="cancelEdit()" style="display:none;">CANCEL EDIT</button>
            <button id="btn-save" class="btn btn-primary" onclick="saveRecord()"><i class="fas fa-save"></i> SAVE RECORD</button>
        </div>
    </div>

    <div id="tab-records" class="content-area">
        <div class="form-group">
            <input id="searchBox" oninput="renderList()" placeholder="SEARCH BY NAME..." style="box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);">
        </div>
        <div id="resultList" style="margin-top:15px; margin-bottom: 20px;"></div>
        
        <div class="pagination">
            <button id="btn-prev-rec" class="page-btn" onclick="changeRecPage(-1)">Prev</button>
            <span id="rec-page-indicator" style="align-self:center; font-size:12px; font-weight:600; color:var(--text-light);">Page 1</span>
            <button id="btn-next-rec" class="page-btn" onclick="changeRecPage(1)">Next</button>
        </div>

        <div class="static-export-bar">
            <button class="btn btn-success" onclick="openExportModal()"><i class="fas fa-file-excel"></i> EXPORT TO EXCEL</button>
        </div>
    </div>

    <div id="tab-households" class="content-area">
        <div style="display:flex; gap:10px; margin-bottom:20px;">
            <input id="searchHH" oninput="renderHouseholdList()" placeholder="Search Household or Member..." style="flex:1;">
            <button class="btn btn-primary" style="width:auto;" onclick="openHHModal()"><i class="fas fa-plus"></i></button>
        </div>
        <div id="hh-list-container"></div>
        <div class="pagination">
            <button id="btn-prev-hh" class="page-btn" onclick="changeHHPage(-1)">Prev</button>
            <span id="hh-page-indicator" style="align-self:center; font-size:12px; font-weight:600; color:var(--text-light);">Page 1</span>
            <button id="btn-next-hh" class="page-btn" onclick="changeHHPage(1)">Next</button>
        </div>
    </div>

    <div id="tab-config" class="content-area">
        <div class="card-section">
            <h5 class="section-title">SYSTEM CONFIGURATION</h5>
            
            <div class="form-group">
                <label>Manage Additional Addresses</label>
                <div style="display:flex; gap:10px; margin-bottom:10px;">
                    <input id="newAddress" placeholder="e.g. UPPER BASAK">
                    <button class="btn btn-small btn-success" onclick="addAddress()">ADD</button>
                </div>
                <div class="list" id="listAddresses" style="max-height:200px; overflow-y:auto; border:1px solid #f1f5f9; border-radius:10px;"></div>
            </div>
            <hr style="border:0; border-top:1px solid #eee; margin:30px 0;">
            <div class="form-group">
                 <label>Admin Password Management</label>
                 <button class="btn btn-ghost" onclick="forgotPassword()">Reset Admin Password</button>
            </div>
        </div>
    </div>

    <div class="app-footer">SEC JERICK&#x2122;</div>

</div>

<input type="hidden" id="tempPurokTarget">

<div id="viewer-overlay" class="modal-overlay" onclick="if(event.target===this) closeViewer()">
    <div class="viewer-card" style="background:white; width:100%; max-width:500px; height:90vh; border-radius:20px 20px 0 0; position:absolute; bottom:0; padding:30px; overflow-y:auto; animation: slideUp 0.3s;">
        <h3 style="color:var(--primary); border-bottom:2px solid var(--accent); padding-bottom:15px; margin-bottom:25px; font-weight:800;">RECORD DETAILS</h3>
        <div id="viewer-content"></div>
        <div id="viewer-actions" style="margin-top:30px; display:flex; flex-direction:column; gap:12px;"></div>
    </div>
</div>

<style> @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } } </style>

<script>
// --- PWA INSTALLATION ---
let deferredPrompt;
const installBtn = document.getElementById('install-btn');

if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js').then(reg => {
        reg.addEventListener('updatefound', () => {
            const newWorker = reg.installing;
            newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                    showToast("New Update Available! Please refresh.", "success");
                }
            });
        });
    }).catch(err => console.log('SW Fail', err));
}

window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installBtn.style.display = 'flex';
});

installBtn.addEventListener('click', async () => {
    if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        console.log(`User response: ${outcome}`);
        deferredPrompt = null;
        installBtn.style.display = 'none';
    }
});

window.addEventListener('appinstalled', () => {
    installBtn.style.display = 'none';
    showToast("App Installed Successfully!", "success");
});

// --- CONFIGURATION ---
const HEADERS_RBIS = [
    "INHABITANT TYPE", "LAST NAME", "FIRST NAME", "MIDDLE NAME", "SUFFIX", 
    "BIRTH PLACE", "BIRTHDATE (YYYY-MM-DD)", "SEX", "CIVIL STATUS", "CITIZENSHIP", 
    "PROFESSION/ OCCUPATION", "CONTACT NUMBER", "EMAIL ADDRESS", 
    "HIGHEST EDUCATIONAL ATTAINMENT", "MOTHER'S FIRST NAME", 
    "MOTHER'S MIDDLE NAME", "MOTHER'S LAST NAME",
    "PUROK/SITIO", "ADDITIONAL ADDRESS", "RELIGION", 
    "IS OSY", "IS PWD", "IS 4Ps", "IS IPS", "IS SOLO PARENT",
    "LABOR STATUS", "IS OFW", "IS ISY"
];

const HEADERS_BIMS = [
    "INHABITANT TYPE","LAST NAME","FIRST NAME","MIDDLE NAME","SUFFIX","BIRTH PLACE","BIRTHDATE (YYYY-MM-DD)","SEX","CIVIL STATUS","CITIZENSHIP","PROFESSION/ OCCUPATION","CONTACT NUMBER","EMAIL ADDRESS","HIGHEST EDUCATIONAL ATTAINMENT","MOTHER'S FIRST NAME","MOTHER'S MIDDLE NAME","MOTHER'S LAST NAME"
];

// PATCH 2: Embedded BIMS template (Import_Inhabitant_Template_v1_4_2.xlsx)
// This guarantees the exported file is accepted by BIMS without format errors.
const BIMS_TEMPLATE_B64 = "UEsDBBQACAgIAFxDflsAAAAAAAAAAAAAAAAYAAAAeGwvZHJhd2luZ3MvZHJhd2luZzEueG1sndBdbsIwDAfwE+wOVd5pWhgTQxRe0E4wDuAlbhuRj8oOo9x+0Uo2aXsBHm3LP/nvzW50tvhEYhN8I+qyEgV6FbTxXSMO72+zlSg4gtdgg8dGXJDFbvu0GTWtz7ynIu17XqeyEX2Mw1pKVj064DIM6NO0DeQgppI6qQnOSXZWzqvqRfJACJp7xLifJuLqwQOaA+Pz/k3XhLY1CvdBnRz6OCGEFmL6Bfdm4KypB65RPVD8AcZ/gjOKAoc2liq46ynZSEL9PAk4/hr13chSvsrVX8jdFMcBHU/DLLlDesiHsSZevpNlRnfugbdoAx2By8i4OPjj3bEqyTa1KCtssV7ercyzIrdfUEsHCAdiaYMFAQAABwMAAFBLAwQUAAgICABcQ35bAAAAAAAAAAAAAAAAGAAAAHhsL2RyYXdpbmdzL2RyYXdpbmcyLnhtbJ3QXW7CMAwH8BPsDlXeaVoYE0MUXtBOMA7gJW4bkY/KDqPcftFKNml7AR5tyz/5781udLb4RGITfCPqshIFehW08V0jDu9vs5UoOILXYIPHRlyQxW77tBk1rc+8pyLte16nshF9jMNaSlY9OuAyDOjTtA3kIKaSOqkJzkl2Vs6r6kXyQAiae8S4nybi6sEDmgPj8/5N14S2NQr3QZ0c+jghhBZi+gX3ZuCsqQeuUT1Q/AHGf4IzigKHNpYquOsp2UhC/TwJOP4a9d3IUr7K1V/I3RTHAR1Pwyy5Q3rIh7EmXr6TZUZ37oG3aAMdgcvIuDj4492xKsk2tSgrbLFe3q3MsyK3X1BLBwgHYmmDBQEAAAcDAABQSwMEFAAICAgAXEN+WwAAAAAAAAAAAAAAABgAAAB4bC93b3Jrc2hlZXRzL3NoZWV0MS54bWyd3dmSHMeVqOsnOO8g4/0WWZWzTNK2Zg4RGZkRGfN0xyOxu2VbFNtIqtX77Q8FDqqMj0UsOzei+MHdkYAvgKgfkVW//9//89Vff/PfX37z7V++/tsfPnn57Wef/ObLv/3p6z//5W//8YdPuvbyv/af/Obb777425+/+OvXf/vyD5/83y+//eR///H/+f0/vv7m/3z7n19++d1vvj/gb9/+4ZP//O67//rdp59++6f//PKrL7797df/9eXfvv+Wf//6m6+++O77f/3mPz799r+++fKLP3/Y9NVfP3397LPtp1998Ze/ffLDCb/7JnLG1//+73/505enr//096++/Nt3PxzyzZd//eK771/+t//5l//69qfTvvofjvvqL3/65utvv/737377p6+/+vGk71/Bnz798n/+9OWHF7R/ekFf/Snyir764pv/8/f/+l/fH/lf37+K//cvf/3Ld//3w+v6+Zj//sMnf//mb7/78Yz/9fPL+Oee333//f/uv7/660+L/+dlHXvd/GQePj08vfr/edn8/zvp5bNPX14WR62/8Oci/rK++NPPJ30VO+bnG/lxRP74+w9Hlt/88fdf//27v/7lb1+W3/zm279/9f1P/v/9/Mu/fv2PP3zy/eD+CPVf/uM/v/snfPrH33/6874P/6f/y5f/+PbN///NP8f4//366//zz3+5/vlp09u1lw8X/v33+ae/f/vd11+lX/7wXbx88ps/f/nvX/z9r98dv/7r8Jc/f/ef39vrb7ern73++h8/L9789sPpf/r6r99++N8fD/tp3ye/+eovf/vhn1/8z4d//uOHb1m9/Ha//3HnL+95/XHP6897Xte/3W1+dc/qxz2rf+3Zf+z7Wf+4Z/2vPR9+tL+2Z/Pjns3Pe7a/ffn1Ldsft2x/3vLy2W9//Uez+3HL7u0r+8iPZv/jnv3Pe/Yf+8Ecftxy+Ncre/35Vt+5z89+utDP/rXp5berX39tLz+Pwb/m4HX1sTt9+WkQXv41CS/bj/2gXn4ahZfV2+/rY7t+GoaX9dtJ/cgL/GkaXv41Dq+fffQn46eBePnXRLy+fPQF/jQTL/8aipfDDy/w0x9+EX74tX364rsv/vj7b77+x2+++bD5x1+r3/9U86v9++/tn4v+7ftV335Y+71++73+9x8/+/2n//3PY39c8fkPK17frHh5XnF0xevzitMPK374Qf4Tzku4LCFZQvoDrH+G6xKyJdyWcF8emi9XFEt4LKFcnlEtoV5uaZbQLqFbQr+EYQnjEqYlzG/g0++H4ufJeA1NxuuH3Zs3t7paTMYPK7ZvVqwXk/HDit2bFZvFZLwuJ2MJlyUkS0hfl5OxhGwJtyXcl4fmyxXFEh5LKJdnVEuol1uaJbRL6JbQL2FYwriEaQnz6zuTsQpNxurD7v3Px32+YhC2i0FYbjmtlve+hMsSkiWkq+W9LyFbwm0J9+Wh+XJFsYTHEsrlGdUS6uWWZgntErol9EsYljAuYVrCvHrn3tehe19/2H34172vuffd4t6XW07r5b0v4bKEZAnpennvS8iWcFvCfXlovlxRLOGxhHJ5RrWEermlWUK7hG4J/RKGJYxLmJYwr9+5903o3jc//Bnhszf3vF/8p2Dz4yT89D0eN4zG8nf+zXISlnBZQrKEdLOchCVkS7gt4b48NF+uKJbwWEK5PKNaQr3c0iyhXUK3hH4JwxLGJUxLmDfvTMI2NAnbHybh7R8XD4tJ2C4nYfvRSdguJ2EJlyUkS0i3y0lYQraE2xLuy0Pz5YpiCY8llMszqiXUyy3NEtoldEvolzAsYVzCtIR5+84k7EKTsPthEp4+LFh+5LBbjsKOUXhZfCxx2i1nYQmXJSRLSHfLWVhCtoTbEu7LQ/PlimIJjyWUyzOqJdTLLc0S2iV0S+iXMCxhXMK0hHn3zizsQ7Ow/4VZWHwE+Pl+OQv7j8/CfjkLS7gsIVlCul/OwhKyJdyWcF8emi9XFEt4LKFcnlEtoV5uaZbQLqFbQr+EYQnjEqYlzPt3ZuEQmoXDL8zC8uPGw3IWDh+fhcNyFpZwWUKyhPSwnIUlZEu4LeG+PDRfriiW8FhCuTyjWkK93NIsoV1Ct4R+CcMSxiVMS5gP78zCP/8sGIlLn/3CNKyXfekzb3+zLEyuWf4h4qfva/X2nMWHoecfF73tTktJkPRHeTM4SIbckDsn56wpkAdSck6F1OxqkBbpkB4ZkBGZkPmtPI9SsFO+/MIo7Zaj9OIo7Zej5BpGyVxprzRYWixNljZLo6XV0mxptzRcWi5Nl7ZL46X10nxpvzRgWjBNmDbM9yLmS6xivrz+NDef/jwldsuXw3JKXMOUkC6RC5Ig6Qv5EsmQG3Ln5Jw1BfJASs6pkJpdDdIiHdIjAzIiEzK/vBc0X2JF82Xl7y6v/EWImfOVvwpxDXND+kQuSIKkL+RPJENuyJ2Tc9YUyAMpOadCanY1SIt0SI8MyIhMyPzyXhB9iRXRl7W/uxhFX1+XU+IapoRQilyQBElfiKVIhtyQOyfnrCmQB1JyToXU7GqQFumQHhmQEZmQ+eW9fPoS66cvG6fkR1q/HZPVckw+HlF/OufX/9RLWUUSJH0hriIZckPunJyzpkAeSMk5FVKzq0FapEN6ZEBGZELmt/I8ObHe+rJ1cra/MDnLv3d9+Xh0/emcX58cSiySIOkLMRbJkBty5+ScNQXyQErOqZCaXQ3SIh3SIwMyIhMyv5XnyYn12Zedk7P7hcnhI20bLZOzi0wO3RZJkPSFdItkyA25c3LOmgJ5ICXnVEjNrgZpkQ7pkQEZkQmZX96LuS+xmvuyd3L2vzA5y7/if7HoMjn7yORQeZEESV8IvUiG3JA7J+esKZAHUnJOhdTsapAW6ZAeGZARmZD55b30+xJrvy8HJ+fwC5OzfEjgxf7L5Bwik0MTRhIkfSELIxlyQ+6cnLOmQB5IyTkVUrOrQVqkQ3pkQEZkQuaX90LxaywUv37G5PxET5OzjHmvH+/Cr5Eu/EoXRhIkfaULIxlyQ+6cnLOmQB5IyTkVUrOrQVqkQ3pkQEZkQubX97rwa6wLv/5CF35dPpPwavNdfbYcpY934Ve6MHJBEiR9pQsjGXJD7pycs6ZAHkjJORVSs6tBWqRDemRARmRC5tf3uvBr8OlWu/CrzXe17Hu/sIYp8ZFWn2n1oVafavWxVp9r9cFWn2z10VafbfXhVp9u9fFWn2/1AVefcPURV59x9SFXn3L1MVefc32vC7/GuvDrL3Th1fLRhtefmu+nP0+JFZi/0H4lAyMXJEHSVzIwkiE35M7JOWsK5IGUnFMhNbsapEU6pEcGZEQmZH4rz2MSy8Cv618YE56WXzMmZmDHhA6MXJAESV/pwEiG3JA7J+esKZAHUnJOhdTsapAW6ZAeGZARmZD5rTyPSawDv25+YUyWj0O88ijtz/JrY8LTtMgFSZD0leiLZMgNuXNyzpoCeSAl51RIza4GaZEO6ZEBGZEJmd/K85jEou/r9hfGZLMcE56z/Vl+bUx41Ba5IAmSvlJ4kQy5IXdOzllTIA+k5JwKqdnVIC3SIT0yICMyIfNbeR6TWOF9/YVHcFfb5ZjwDO6rgdcx+fHopzd/7ZYfM1N4kQRJXym8SIbckDsn56wpkAdSck6F1OxqkBbpkB4ZkBGZkPn1vcL7Giu8r7/wwO5q+Y6OV57YfTXwOjk8s4tckARJX8m5SIbckDsn56wpkAdSck6F1OxqkBbpkB4ZkBGZkPn1vZz7Gsu5r7/wLO+KtMLDvK/WXMfkEPkNhpyLJEj6Ss5FMuSG3Dk5Z02BPJCScyqkZleDtEiH9MiAjMiEzK/v5dxVLOeultnxc+SInJAzckESJF2RZZEMuSF3Ts5ZUyAPpOScCqnZ1SAt0iE9MiAjMiHz6r0su4pl2dWLv8DXi+R6WtFTkQuSIOmKnopkyA25c3LOmgJ5ICXnVEjNrgZpkQ7pkQEZkQmZV+/11FWsp65ef+HCl7/tr0ijyAVJkHRFGkUy5IbcOTlnTYE8kJJzKqRmV4O0SIf0yICMyITMq/fS6Cr4SQBWv3Dhy8/7sfJt/r7P3zf6+05/3+rve/19s7/v9vft/r7f3zf8+45/3/Lve/5907/v+vdt/77v3zf++85/3/rve//fi5yrWORc/Rg5nz7fxzJy/rRo9+Y/9NBJOksXKZHSFWETyZAbckdypEAeSIlUSI00SIt0SI8MyIhMyLx6L2yuYmFztVley+fSUTpJZ+kiJVK6Il0iGXJD7kiOFMgDKZEKqZEGaZEO6ZEBGZEJmd/K8yDE0uVq6yBAR+kknaWLlEjpijiJZMgNuSM5UiAPpEQqpEYapEU6pEcGZEQmZF69FydXsTi52jkI0FE6SWfpIiVSuqI1IhlyQ+5IjhTIAymRCqmRBmmRDumRARmRCZlX77XGVaw1rvYOAnSUTtJZukiJlK6oiUiG3JA7kiMF8kBKpEJqpEFapEN6ZEBGZELm1Xs1cRWriauDgwAdpZN0li5SIqUr4iCSITfkjuRIgTyQEqmQGmmQFumQHhmQEZmQefVeHFzH4uB6GZs+R47ICTkjFyRBUuSKZMgNuSM5UiAPpEQqpEYapEU6pEcGZEQmZF6/FwfXsTi4Xtanz5EjckLOyAVJkBS5IhlyQ+5IjhTIAymRCqmRBmmRDumRARmRCZnX79XCdawWrpc56nPkiJyQM3JBEiRFrkiG3JA7kiMF8kBKpEJqpEFapEN6ZEBGZELm9Xv5cB3Lh+tln/ocOSIn5IxckARJkSuSITfkjuRIgTyQEqmQGmmQFumQHhmQEZmQef1eT1wHP5voMkN9jhyRE3JGLkiCpMgVyZAbckdypEAeSIlUSI00SIt0SI8MyIhMyLx+LxuuY9lwvexPnyNH5ISckQuSIClyRTLkhtyRHCmQB1IiFVIjDdIiHdIjAzIiEzK/lecJiPXC9TI8fY4ckRNyRi5IgqTIFcmQG3JHcqRAHkiJVEiNNEiLdEiPDMiITMi8fi8UrmOhcL0sTp8jR+SEnJELkiApckUy5IbckRwpkAdSIhVSIw3SIh3SIwMyIhMyr98rhOtYIVwvU9PnyBE5IWfkgiRIilyRDLkhdyRHCuSBlEiF1EiDtEiH9MiAjMiEzOv30uA6lgbXy8b0OXJETsgZuSAJkiJXJENuyB3JkQJ5ICVSITXSIC3SIT0yICMyIfP6vSa4iTXBDU0QOSIn5IxckARJkSuSITfkjuRIgTyQEqmQGmmQFumQHhmQEZmQefNeE9zEmuCGJogckRNyRi5IgqTIFcmQG3JHcqRAHkiJVEiNNEiLdEiPDMiITMi8ea8JbmJNcEMTRI7ICTkjFyRBUuSKZMgNuSM5UiAPpEQqpEYapEU6pEcGZEQmZN681wQ3sSa4oQkiR+SEnJELkiApckUy5IbckRwpkAdSIhVSIw3SIh3SIwMyIhMyb95rgptYE9zQBJEjckLOyAVJkBS5IhlyQ+5IjhTIAymRCqmRBmmRDumRARmRCZk37zXBTawJbmiCyBE5IWfkgiRIilyRDLkhdyRHCuSBlEiF1EiDtEiH9MiAjMiEzG/leQJiTXBDE0SOyAk5IxckQVLkimTIDbkjOVIgD6REKqRGGqRFOqRHBmREJmTevNcEN7EmuKEJIkfkhJyRC5IgKXJFMuSG3JEcKZAHUiIVUiMN0iId0iMDMiITMm/ea4KbWBPc0ASRI3JCzsgFSZAUuSIZckPuSI4UyAMpkQqpkQZpkQ7pkQEZkQmZN+81wU2sCW5ogsgROSFn5IIkSIpckQy5IXckRwrkgZRIhdRIg7RIh/TIgIzIhMyb95rgNtYEtzRB5IickDNyQRIkRa5IhtyQO5IjBfJASqRCaqRBWqRDemRARmRC5u17TXAba4JbmiByRE7IGbkgCZIiVyRDbsgdyZECeSAlUiE10iAt0iE9MiAjMiHz9r0muI01wS1NEDkiJ+SMXJAESZErkiE35I7kSIE8kBKpkBppkBbpkB4ZkBGZkHn7XhPcxprgliaIHJETckYuSIKkyBXJkBtyR3KkQB5IiVRIjTRIi3RIjwzIiEzIvH2vCW5jTXBLE0SOyAk5IxckQVLkimTIDbkjOVIgD6REKqRGGqRFOqRHBmREJmTevtcEt7EmuKUJIkfkhJyRC5IgKXJFMuSG3JEcKZAHUiIVUiMN0iId0iMDMiITMr+V5wmINcEtTRA5IifkjFyQBEmRK5IhN+SO5EiBPJASqZAaaZAW6ZAeGZARmZB5+14T3Maa4JYmiByRE3JGLkiCpMgVyZAbckdypEAeSIlUSI00SIt0SI8MyIhMyLx9rwluY01wSxNEjsgJOSMXJEFS5IpkyA25IzlSIA+kRCqkRhqkRTqkRwZkRCZk3r7XBLexJrilCSJH5ISckQuSIClyRTLkhtyRHCmQB1IiFVIjDdIiHdIjAzIiEzJv32uCu1gT3NEEkSNyQs7IBUmQFLkiGXJD7kiOFMgDKZEKqZEGaZEO6ZEBGZEJmXfvNcFdrAnuaILIETkhZ+SCJEiKXJEMuSF3JEcK5IGUSIXUSIO0SIf0yICMyITMu/ea4C7WBHc0QeSInJAzckESJEWuSIbckDuSIwXyQEqkQmqkQVqkQ3pkQEZkQubde01wF2uCO5ogckROyBm5IAmSIlckQ27IHcmRAnkgJVIhNdIgLdIhPTIgIzIh8+69JriLNcEdTRA5IifkjFyQBEmRK5IhN+SO5EiBPJASqZAaaZAW6ZAeGZARmZB5914T3MWa4I4miByRE3JGLkiCpMgVyZAbckdypEAeSIlUSI00SIt0SI8MyIhMyPxWnicg1gR3NEHkiJyQM3JBEiRFrkiG3JA7kiMF8kBKpEJqpEFapEN6ZEBGZELm3XtNcBdrgjuaIHJETsgZuSAJkiJXJENuyB3JkQJ5ICVSITXSIC3SIT0yICMyIfPuvSa4izXBHU0QOSIn5IxckARJkSuSITfkjuRIgTyQEqmQGmmQFumQHhmQEZmQefdeE9zFmuCOJogckRNyRi5IgqTIFcmQG3JHcqRAHkiJVEiNNEiLdEiPDMiITMi8e68J7mNNcE8TRI7ICTkjFyRBUuSKZMgNuSM5UiAPpEQqpEYapEU6pEcGZEQmZN6/1wT3sSa4pwkiR+SEnJELkiApckUy5IbckRwpkAdSIhVSIw3SIh3SIwMyIhMy799rgvtYE9zTBJEjckLOyAVJkBS5IhlyQ+5IjhTIAymRCqmRBmmRDumRARmRCZn37zXBfawJ7mmCyBE5IWfkgiRIilyRDLkhdyRHCuSBlEiF1EiDtEiH9MiAjMiEzPv3muA+1gT3NEHkiJyQM3JBEiRFrkiG3JA7kiMF8kBKpEJqpEFapEN6ZEBGZELm/XtNcB9rgnuaIHJETsgZuSAJkiJXJENuyB3JkQJ5ICVSITXSIC3SIT0yICMyIfNbeZ6AWBPc0wSRI3JCzsgFSZAUuSIZckPuSI4UyAMpkQqpkQZpkQ7pkQEZkQmZ9+81wX2sCe5pgsgROSFn5IIkSIpckQy5IXckRwrkgZRIhdRIg7RIh/TIgIzIhMz795rgPtYE9zRB5IickDNyQRIkRa5IhtyQO5IjBfJASqRCaqRBWqRDemRARmRC5v17TXAfa4J7miByRE7IGbkgCZIiVyRDbsgdyZECeSAlUiE10iAt0iE9MiAjMiHz/r0meIg1wQNNEDkiJ+SMXJAESZErkiE35I7kSIE8kBKpkBppkBbpkB4ZkBGZkPnwXhM8xJrggSaIHJETckYuSIKkyBXJkBtyR3KkQB5IiVRIjTRIi3RIjwzIiEzIfHivCR5iTfBAE0SOyAk5IxckQVLkimTIDbkjOVIgD6REKqRGGqRFOqRHBmREJmQ+vNcED7EmeKAJIkfkhJyRC5IgKXJFMuSG3JEcKZAHUiIVUiMN0iId0iMDMiITMh/ea4KHWBM80ASRI3JCzsgFSZAUuSIZckPuSI4UyAMpkQqpkQZpkQ7pkQEZkQmZD+81wUOsCR5ogsgROSFn5IIkSIpckQy5IXckRwrkgZRIhdRIg7RIh/TIgIzIhMxv5XkCYk3wQBNEjsgJOSMXJEFS5IpkyA25IzlSIA+kRCqkRhqkRTqkRwZkRCZkPrzXBA+xJnigCSJH5ISckQuSIClyRTLkhtyRHCmQB1IiFVIjDdIiHdIjAzIiEzIf3muCh1gTPNAEkSNyQs7IBUmQFLkiGXJD7kiOFMgDKZEKqZEGaZEO6ZEBGZEJmQ/vNcFDrAkeaILIETkhZ+SCJEiKXJEMuSF3JEcK5IGUSIXUSIO0SIf0yICMyITMh/ea4MtnsSj4Yd3zDEhH6SSdpYuUSKl0lTLpJt2lXCqkh1RKlVRLjdRKndRLgzRKkzQ/0WI4Yr3ww7rlcFAMpZN0li5SIqXSVcqkm3SXcqmQHlIpVVItNVIrdVIvDdIoTdL8RIvhiKXED+uWw0FMlE7SWbpIiZRKVymTbtJdyqVCekilVEm11Eit1Em9NEijNEnzEy2GI1YZP6xbDgedUTpJZ+kiJVIqXaVMukl3KZcK6SGVUiXVUiO1Uif10iCN0iTNT7QYjliA/LBuORwkSOkknaWLlEipdJUy6SbdpVwqpIdUSpVUS43USp3US4M0SpM0P9FiOGJt8sO65XBQJ6WTdJYuUiKl0lXKpJt0l3KpkB5SKVVSLTVSK3VSLw3SKE3S/ESL4Yhlyw/rlsNBuJRO0lm6SImUSlcpk27SXcqlQnpIpVRJtdRIrdRJvTRIozRJ8xMthiNWND+sWw4HTVM6SWfpIiVSKl2lTLpJdymXCukhlVIl1VIjtVIn9dIgjdIkzU+0GI5Y7Pywbjkc5E7pJJ2li5RIqXSVMukm3aVcKqSHVEqVVEuN1Eqd1EuDNEqTND/RYjhiHfTDuuVwUEKlk3SWLlIipdJVyqSbdJdyqZAeUilVUi01Uit1Ui8N0ihN0vxEz8PxEiykLxZS6CidpLN0kRIpla5SJt2ku5RLhfSQSqmSaqmRWqmTemmQRmmS5idaDEewkL5YSKGjdJLO0kVKpFS6Spl0k+5SLhXSQyqlSqqlRmqlTuqlQRqlSZqfaDEcwUL6YiGFjtJJOksXKZFS6Spl0k26S7lUSA+plCqplhqplTqplwZplCZpfqLFcAQL6YuFFDpKJ+ksXaRESqWrlEk36S7lUiE9pFKqpFpqpFbqpF4apFGapPmJFsMRLKQvFlLoKJ2ks3SREimVrlIm3aS7lEuF9JBKqZJqqZFaqZN6aZBGaZLmJ1oMR7CQvlhIoaN0ks7SRUqkVLpKmXST7lIuFdJDKqVKqqVGaqVO6qVBGqVJmp9oMRzBQvpiIYWO0kk6SxcpkVLpKmXSTbpLuVRID6mUKqmWGqmVOqmXBmmUJml+osVwBAvpi4UUOkon6SxdpERKpauUSTfpLuVSIT2kUqqkWmqkVuqkXhqkUZqk+YkWwxEspC8WUugonaSzdJESKZWuUibdpLuUS4X0kEqpkmqpkVqpk3ppkEZpkuYnWgxHsJC+WEiho3SSztJFSqRUukqZdJPuUi4V0kMqpUqqpUZqpU7qpUEapUman+h5OF6DhfTVQgodpZN0li5SIqXSVcqkm3SXcqmQHlIpVVItNVIrdVIvDdIoTdL8RIvhCBbSVwspdJRO0lm6SImUSlcpk27SXcqlQnpIpVRJtdRIrdRJvTRIozRJ8xMthiNYSF8tpNBROkln6SIlUipdpUy6SXcplwrpIZVSJdVSI7VSJ/XSII3SJM1PtBiOYCF9tZBCR+kknaWLlEipdJUy6SbdpVwqpIdUSpVUS43USp3US4M0SpM0P9FiOIKF9NVCCh2lk3SWLlIipdJVyqSbdJdyqZAeUilVUi01Uit1Ui8N0ihN0vxEi+EIFtJXCyl0lE7SWbpIiZRKVymTbtJdyqVCekilVEm11Eit1Em9NEijNEnzEy2GI1hIXy2k0FE6SWfpIiVSKl2lTLpJdymXCukhlVIl1VIjtVIn9dIgjdIkzU+0GI5gIX21kEJH6SSdpYuUSKl0lTLpJt2lXCqkh1RKlVRLjdRKndRLgzRKkzQ/0WI4goX01UIKHaWTdJYuUiKl0lXKpJt0l3KpkB5SKVVSLTVSK3VSLw3SKE3S/ESL4QgW0lcLKXSUTtJZukiJlEpXKZNu0l3KpUJ6SKVUSbXUSK3USb00SKM0SfMTPQ/HKlhIVxZS6CidpLN0kRIpla5SJt2ku5RLhfSQSqmSaqmRWqmTemmQRmmS5idaDEewkK4spNBROkln6SIlUipdpUy6SXcplwrpIZVSJdVSI7VSJ/XSII3SJM1PtBiOYCFdWUiho3SSztJFSqRUukqZdJPuUi4V0kMqpUqqpUZqpU7qpUEapUman2gxHMFCurKQQkfpJJ2li5RIqXSVMukm3aVcKqSHVEqVVEuN1Eqd1EuDNEqTND/RYjiChXRlIYWO0kk6SxcpkVLpKmXSTbpLuVRID6mUKqmWGqmVOqmXBmmUJml+osVwBAvpykIKHaWTdJYuUiKl0lXKpJt0l3KpkB5SKVVSLTVSK3VSLw3SKE3S/ESL4QgW0pWFFDpKJ+ksXaRESqWrlEk36S7lUiE9pFKqpFpqpFbqpF4apFGapPmJFsMRLKQrCyl0lE7SWbpIiZRKVymTbtJdyqVCekilVEm11Eit1Em9NEijNEnzEy2GI1hIVxZS6CidpLN0kRIpla5SJt2ku5RLhfSQSqmSaqmRWqmTemmQRmmS5idaDEewkK4spNBROkln6SIlUipdpUy6SXcplwrpIZVSJdVSI7VSJ/XSII3SJM1P9Dwc62AhXVtIoaN0ks7SRUqkVLpKmXST7lIuFdJDKqVKqqVGaqVO6qVBGqVJmp9oMRzBQrq2kEJH6SSdpYuUSKl0lTLpJt2lXCqkh1RKlVRLjdRKndRLgzRKkzQ/0WI4goV0bSGFjtJJOksXKZFS6Spl0k26S7lUSA+plCqplhqplTqplwZplCZpfqLFcAQL6dpCCh2lk3SWLlIipdJVyqSbdJdyqZAeUilVUi01Uit1Ui8N0ihN0vxEi+EIFtK1hRQ6SifpLF2kREqlq5RJN+ku5VIhPaRSqqRaaqRW6qReGqRRmqT5iRbDESykawspdJRO0lm6SImUSlcpk27SXcqlQnpIpVRJtdRIrdRJvTRIozRJ8xMthiNYSNcWUugonaSzdJESKZWuUibdpLuUS4X0kEqpkmqpkVqpk3ppkEZpkuYnWgxHsJCuLaTQUTpJZ+kiJVIqXaVMukl3KZcK6SGVUiXVUiO1Uif10iCN0iTNT7QYjmAhXVtIoaN0ks7SRUqkVLpKmXST7lIuFdJDKqVKqqVGaqVO6qVBGqVJmp9oMRzBQrq2kEJH6SSdpYuUSKl0lTLpJt2lXCqkh1RKlVRLjdRKndRLgzRKkzQ/0fNwbIKFdGMhhY7SSTpLFymRUukqZdJNuku5VEgPqZQqqZYaqZU6qZcGaZQmaX6ixXAEC+nGQgodpZN0li5SIqXSVcqkm3SXcqmQHlIpVVItNVIrdVIvDdIoTdL8RIvhCBbSjYUUOkon6SxdpERKpauUSTfpLuVSIT2kUqqkWmqkVuqkXhqkUZqk+YkWwxEspBsLKXSUTtJZukiJlEpXKZNu0l3KpUJ6SKVUSbXUSK3USb00SKM0SfMTLYYjWEg3FlLoKJ2ks3SREimVrlIm3aS7lEuF9JBKqZJqqZFaqZN6aZBGaZLmJ1oMR7CQbiyk0FE6SWfpIiVSKl2lTLpJdymXCukhlVIl1VIjtVIn9dIgjdIkzU+0GI5gId1YSKGjdJLO0kVKpFS6Spl0k+5SLhXSQyqlSqqlRmqlTuqlQRqlSZqfaDEcwUK6sZBCR+kknaWLlEipdJUy6SbdpVwqpIdUSpVUS43USp3US4M0SpM0P9FiOIKFdGMhhY7SSTpLFymRUukqZdJNuku5VEgPqZQqqZYaqZU6qZcGaZQmaX6ixXAEC+nGQgodpZN0li5SIqXSVcqkm3SXcqmQHlIpVVItNVIrdVIvDdIoTdL8RM/DsQ0W0q2FFDpKJ+ksXaRESqWrlEk36S7lUiE9pFKqpFpqpFbqpF4apFGapPmJFsMRLKRbCyl0lE7SWbpIiZRKVymTbtJdyqVCekilVEm11Eit1Em9NEijNEnzEy2GI1hItxZS6CidpLN0kRIpla5SJt2ku5RLhfSQSqmSaqmRWqmTemmQRmmS5idaDEewkG4tpNBROkln6SIlUipdpUy6SXcplwrpIZVSJdVSI7VSJ/XSII3SJM1PtBiOYCHdWkiho3SSztJFSqRUukqZdJPuUi4V0kMqpUqqpUZqpU7qpUEapUman2gxHMFCurWQQkfpJJ2li5RIqXSVMukm3aVcKqSHVEqVVEuN1Eqd1EuDNEqTND/RYjiChXRrIYWO0kk6SxcpkVLpKmXSTbpLuVRID6mUKqmWGqmVOqmXBmmUJml+osVwBAvp1kIKHaWTdJYuUiKl0lXKpJt0l3KpkB5SKVVSLTVSK3VSLw3SKE3S/ESL4QgW0q2FFDpKJ+ksXaRESqWrlEk36S7lUiE9pFKqpFpqpFbqpF4apFGapPmJFsMRLKRbCyl0lE7SWbpIiZRKVymTbtJdyqVCekilVEm11Eit1Em9NEijNEnzEz0Pxy5YSHcWUugonaSzdJESKZWuUibdpLuUS4X0kEqpkmqpkVqpk3ppkEZpkuYnWgxHsJDuLKTQUTpJZ+kiJVIqXaVMukl3KZcK6SGVUiXVUiO1Uif10iCN0iTNT7QYjmAh3VlIoaN0ks7SRUqkVLpKmXST7lIuFdJDKqVKqqVGaqVO6qVBGqVJmp9oMRzBQrqzkEJH6SSdpYuUSKl0lTLpJt2lXCqkh1RKlVRLjdRKndRLgzRKkzQ/0WI4goV0ZyGFjtJJOksXKZFS6Spl0k26S7lUSA+plCqplhqplTqplwZplCZpfqLFcAQL6c5CCh2lk3SWLlIipdJVyqSbdJdyqZAeUilVUi01Uit1Ui8N0ihN0vxEi+EIFtKdhRQ6SifpLF2kREqlq5RJN+ku5VIhPaRSqqRaaqRW6qReGqRRmqT5iRbDESykOwspdJRO0lm6SImUSlcpk27SXcqlQnpIpVRJtdRIrdRJvTRIozRJ8xMthiNYSHcWUugonaSzdJESKZWuUibdpLuUS4X0kEqpkmqpkVqpk3ppkEZpkuYnWgxHsJDuLKTQUTpJZ+kiJVIqXaVMukl3KZcK6SGVUiXVUiO1Uif10iCN0iTNT/Q8HPtgId1bSKGjdJLO0kVKpFS6Spl0k+5SLhXSQyqlSqqlRmqlTuqlQRqlSZqfaDEcwUK6t5BCR+kknaWLlEipdJUy6SbdpVwqpIdUSpVUS43USp3US4M0SpM0P9FiOIKFdG8hhY7SSTpLFymRUukqZdJNuku5VEgPqZQqqZYaqZU6qZcGaZQmaX6ixXAEC+neQgodpZN0li5SIqXSVcqkm3SXcqmQHlIpVVItNVIrdVIvDdIoTdL8RIvhCBbSvYUUOkon6SxdpERKpauUSTfpLuVSIT2kUqqkWmqkVuqkXhqkUZqk+YkWwxEspHsLKXSUTtJZukiJlEpXKZNu0l3KpUJ6SKVUSbXUSK3USb00SKM0SfMTLYYjWEj3FlLoKJ2ks3SREimVrlIm3aS7lEuF9JBKqZJqqZFaqZN6aZBGaZLmJ1oMR7CQ7i2k0FE6SWfpIiVSKl2lTLpJdymXCukhlVIl1VIjtVIn9dIgjdIkzU+0GI5gId1bSKGjdJLO0kVKpFS6Spl0k+5SLhXSQyqlSqqlRmqlTuqlQRqlSZqfaDEcwUK6t5BCR+kknaWLlEipdJUy6SbdpVwqpIdUSpVUS43USp3US4M0SpM0P9HzcByChfRgIYWO0kk6SxcpkVLpKmXSTbpLuVRID6mUKqmWGqmVOqmXBmmUJml+osVwBAvpwUIKHaWTdJYuUiKl0lXKpJt0l3KpkB5SKVVSLTVSK3VSLw3SKE3S/ESL4QgW0oOFFDpKJ+ksXaRESqWrlEk36S7lUiE9pFKqpFpqpFbqpF4apFGapPmJFsMRLKQHCyl0lE7SWbpIiZRKVymTbtJdyqVCekilVEm11Eit1Em9NEijNEnzEy2GI1hIDxZS6CidpLN0kRIpla5SJt2ku5RLhfSQSqmSaqmRWqmTemmQRmmS5idaDEewkB4spNBROkln6SIlUipdpUy6SXcplwrpIZVSJdVSI7VSJ/XSII3SJM1PtBiOYCE9WEiho3SSztJFSqRUukqZdJPuUi4V0kMqpUqqpUZqpU7qpUEapUman2gxHMFCerCQQkfpJJ2li5RIqXSVMukm3aVcKqSHVEqVVEuN1Eqd1EuDNEqTND/RYjiChfRgIYWO0kk6SxcpkVLpKmXSTbpLuVRID6mUKqmWGqmVOqmXBmmUJml+osVwBAvpwUIKHaWTdJYuUiKl0lXKpJt0l3KpkB5SKVVSLTVSK3VSLw3SKE3S/ERPw/H6WayQflj3PBzSUTpJZ+kiJVIqXaVMukl3KZcK6SGVUiXVUiO1Uif10iCN0iTNT7QYjlgh/bBuORwUUukknaWLlEipdJUy6SbdpVwqpIdUSpVUS43USp3US4M0SpM0P9FiOGKF9MO65XBQSKWTdJYuUiKl0lXKpJt0l3KpkB5SKVVSLTVSK3VSLw3SKE3S/ESL4YgV0g/rlsNBIZVO0lm6SImUSlcpk27SXcqlQnpIpVRJtdRIrdRJvTRIozRJ8xMthiNWSD+sWw4HhVQ6SWfpIiVSKl2lTLpJdymXCukhlVIl1VIjtVIn9dIgjdIkzU+0GI5YIf2wbjkcFFLpJJ2li5RIqXSVMukm3aVcKqSHVEqVVEuN1Eqd1EuDNEqTND/RYjhihfTDuuVwUEilk3SWLlIipdJVyqSbdJdyqZAeUilVUi01Uit1Ui8N0ihN0vxEi+GIFdIP65bDQSGVTtJZukiJlEpXKZNu0l3KpUJ6SKVUSbXUSK3USb00SKM0SfMTLYYjVkg/rFsOB4VUOkln6SIlUipdpUy6SXcplwrpIZVSJdVSI7VSJ/XSII3SJM1PtBiOWCH9sG45HBRS6SSdpYuUSKl0lTLpJt2lXCqkh1RKlVRLjdRKndRLgzRKkzQ/0fNwvAQL6YuFFDpKJ+ksXaRESqWrlEk36S7lUiE9pFKqpFpqpFbqpF4apFGapPmJFsMRLKQvFlLoKJ2ks3SREimVrlIm3aS7lEuF9JBKqZJqqZFaqZN6aZBGaZLmJ1oMR7CQvlhIoaN0ks7SRUqkVLpKmXST7lIuFdJDKqVKqqVGaqVO6qVBGqVJmp9oMRzBQvpiIYWO0kk6SxcpkVLpKmXSTbpLuVRID6mUKqmWGqmVOqmXBmmUJml+osVwBAvpi4UUOkon6SxdpERKpauUSTfpLuVSIT2kUqqkWmqkVuqkXhqkUZqk+YkWwxEspC8WUugonaSzdJESKZWuUibdpLuUS4X0kEqpkmqpkVqpk3ppkEZpkuYnWgxHsJC+WEiho3SSztJFSqRUukqZdJPuUi4V0kMqpUqqpUZqpU7qpUEapUman2gxHMFC+mIhhY7SSTpLFymRUukqZdJNuku5VEgPqZQqqZYaqZU6qZcGaZQmaX6ixXAEC+mLhRQ6SifpLF2kREqlq5RJN+ku5VIhPaRSqqRaaqRW6qReGqRRmqT5iRbDESykLxZS6CidpLN0kRIpla5SJt2ku5RLhfSQSqmSaqmRWqmTemmQRmmS5id6Ho7XYCF9tZBCR+kknaWLlEipdJUy6SbdpVwqpIdUSpVUS43USp3US4M0SpM0P9FiOIKF9NVCCh2lk3SWLlIipdJVyqSbdJdyqZAeUilVUi01Uit1Ui8N0ihN0vxEi+EIFtJXCyl0lE7SWbpIiZRKVymTbtJdyqVCekilVEm11Eit1Em9NEijNEnzEy2GI1hIXy2k0FE6SWfpIiVSKl2lTLpJdymXCukhlVIl1VIjtVIn9dIgjdIkzU+0GI5gIX21kEJH6SSdpYuUSKl0lTLpJt2lXCqkh1RKlVRLjdRKndRLgzRKkzQ/0WI4goX01UIKHaWTdJYuUiKl0lXKpJt0l3KpkB5SKVVSLTVSK3VSLw3SKE3S/ESL4QgW0lcLKXSUTtJZukiJlEpXKZNu0l3KpUJ6SKVUSbXUSK3USb00SKM0SfMTLYYjWEhfLaTQUTpJZ+kiJVIqXaVMukl3KZcK6SGVUiXVUiO1Uif10iCN0iTNT7QYjmAhfbWQQkfpJJ2li5RIqXSVMukm3aVcKqSHVEqVVEuN1Eqd1EuDNEqTND/RYjiChfTVQgodpZN0li5SIqXSVcqkm3SXcqmQHlIpVVItNVIrdVIvDdIoTdL8RM/DsQoW0pWFFDpKJ+ksXaRESqWrlEk36S7lUiE9pFKqpFpqpFbqpF4apFGapPmJFsMRLKQrCyl0lE7SWbpIiZRKVymTbtJdyqVCekilVEm11Eit1Em9NEijNEnzEy2GI1hIVxZS6CidpLN0kRIpla5SJt2ku5RLhfSQSqmSaqmRWqmTemmQRmmS5idaDEewkK4spNBROkln6SIlUipdpUy6SXcplwrpIZVSJdVSI7VSJ/XSII3SJM1PtBiOXy+kn75Z+eu57O3KX28nb1f++gfSb1f++kdVb1f++h+x36xc//qft96u/PX/+L5d+eu/E79d+eu/LN+uDN/ROnxH6/AdrcN3tA7f0Tp8R5vwHW3Cd7QJ39EmfEeb8B1twne0Cd/RJnxHm/AdbcJ3tA3f0TZ8R9vwHW3Dd7QN39E2fEfb8B1tw3e0Dd/RNnxHu/Ad7cJ3tAvf0S58R7vwHe3Cd7QL39EufEcf+Xrsb1eG7+gjX6n57crwHX3ka7i+XRm+o498dce3K8N39JGv+/Z2ZfiOPvIVod6uDN/RR75WzNuV4Tv6yFeReLsyfEcf+fzyb1eG7+gjn3n67crwHX3kc9K+XRm9o9VHPlvl25XRO1p95PPYvV0ZvaPVRz7D1duV0TtafeRz37xdGb2j1Uc+K8bbleE7+sj75d+uDN/RR95J+3Zl+I4+8h67tyvDd/SRd9+8XRm+o488l/92ZfiOPvLE7tuV4Tv6yLN8b1eG7+gjT/m8XRm+o4/8/f/bleE7+sjfDL5dGb6jj/ydwduV4Tv6SE18uzJ8R+HOsAp3hlW4M6zCnWEV7gyrcGdYhTvDKtwZVuHOsAp3hlW4M6zCnWEV7gyrcGdYhTvDKtwZVuHOsAp3hlW4M6zCnWEV7gyrcGdYhTvDKtwZVuHOsAp3hlW4M6zCnWEV7gyrcGdYhTvDKtwZVuHOsAp3hlW4M6zCnWEV7gyrcGdYhTvDKtwZVuHOsAp3hlW4M6zCnWEV7gyrcGdYhTvDKtwZVuHOsAp3hlW4M6zCnWEV7gyrcGdYhTvDKtwZVuHOsAp3hlW4M6zCnWEV7gyrcGdYhTvDKtwZVuHOsAp3hnW4M6zDnWEd7gzrcGdYhzvDOtwZ1uHOsA53hnW4M6zDnWEd7gzrcGdYhzvDOtwZ1uHOsA53hnW4M6zDnWEd7gzrcGdYhzvDOtwZ1uHOsA53hnW4M6zDnWEd7gzrcGdYhzvDOtwZ1uHOsA53hnW4M6zDnWEd7gzrcGdYhzvDOtwZ1uHOsA53hnW4M6zDnWEd7gzrcGdYhzvDOtwZ1uHOsA53hnW4M6zDnWEd7gzrcGdYhzvDOtwZ1uHOsA53hnW4M6zDnWEd7gzrcGdYhzvDOtwZ1uHOsA53hnW4M6zDnWEd7gzrcGdYhzvDOtwZ1uHOsA53hnW4M6zDnWEd7gzrcGdYhzvDOtwZ1uHOsA53hnW4M6zDnWEd7gzrcGdYhzvDOtwZ1uHOsA53hnW4M6zDnWEd7gzrcGdYhzvDOtwZ1uHOsA53hnW4M6zDnWEd7gzrcGfYhDvDJtwZNuHOsAl3hk24M2zCnWET7gybcGfYhDvDJtwZNuHOsAl3hk24M2zCnWET7gybcGfYhDvDJtwZNuHOsAl3hk24M2zCnWET7gybcGfYhDvDJtwZNuHOsAl3hk24M2zCnWET7gybcGfYhDvDJtwZNuHOsAl3hk24M2zCnWET7gybcGfYhDvDJtwZNuHOsAl3hk24M2zCnWET7gybcGfYhDvDJtwZNuHOsAl3hk24M2zCnWET7gybcGfYhDvDJtwZNuHOsAl3hk24M2zCnWET7gybcGfYhDvDJtwZNuHOsAl3hk24M2zCnWET7gybcGfYhDvDJtwZNuHOsAl3hk24M2zCnWET7gybcGfYhDvDJtwZNuHOsAl3hk24M2zCnWET7gybcGfYhDvDJtwZNuHOsAl3hk24M2zCnWET7gybcGfYhDvDJtwZNuHOsAl3hm24M2zDnWEb7gzbcGfYhjvDNtwZtuHOsA13hm24M2zDnWEb7gzbcGfYhjvDNtwZtuHOsA13hm24M2zDnWEb7gzbcGfYhjvDNtwZtuHOsA13hm24M2zDnWEb7gzbcGfYhjvDNtwZtuHOsA13hm24M2zDnWEb7gzbcGfYhjvDNtwZtuHOsA13hm24M2zDnWEb7gzbcGfYhjvDNtwZtuHOsA13hm24M2zDnWEb7gzbcGfYhjvDNtwZtuHOsA13hm24M2zDnWEb7gzbcGfYhjvDNtwZtuHOsA13hm24M2zDnWEb7gzbcGfYhjvDNtwZtuHOsA13hm24M2zDnWEb7gzbcGfYhjvDNtwZtuHOsA13hm24M2zDnWEb7gzbcGfYhjvDNtwZtuHOsA13hm24M2zDnWEb7gzbcGfYhjvDNtwZtuHOsA13hm24M2zDnWEb7gzbcGfYhTvDLtwZduHOsAt3hl24M+zCnWEX7gy7cGfYhTvDLtwZduHOsAt3hl24M+zCnWEX7gy7cGfYhTvDLtwZduHOsAt3hl24M+zCnWEX7gy7cGfYhTvDLtwZduHOsAt3hl24M+zCnWEX7gy7cGfYhTvDLtwZduHOsAt3hl24M+zCnWEX7gy7cGfYhTvDLtwZduHOsAt3hl24M+zCnWEX7gy7cGfYhTvDLtwZduHOsAt3hl24M+zCnWEX7gy7cGfYhTvDLtwZduHOsAt3hl24M+zCnWEX7gy7cGfYhTvDLtwZduHOsAt3hl24M+zCnWEX7gy7cGfYhTvDLtwZduHOsAt3hl24M+zCnWEX7gy7cGfYhTvDLtwZduHOsAt3hl24M+zCnWEX7gy7cGfYhTvDLtwZduHOsAt3hl24M+zCnWEX7gy7cGfYhTvDLtwZduHOsAt3hn24M+zDnWEf7gz7cGfYhzvDPtwZ9uHOsA93hn24M+zDnWEf7gz7cGfYhzvDPtwZ9uHOsA93hn24M+zDnWEf7gz7cGfYhzvDPtwZ9uHOsA93hn24M+zDnWEf7gz7cGfYhzvDPtwZ9uHOsA93hn24M+zDnWEf7gz7cGfYhzvDPtwZ9uHOsA93hn24M+zDnWEf7gz7cGfYhzvDPtwZ9uHOsA93hn24M+zDnWEf7gz7cGfYhzvDPtwZ9uHOsA93hn24M+zDnWEf7gz7cGfYhzvDPtwZ9uHOsA93hn24M+zDnWEf7gz7cGfYhzvDPtwZ9uHOsA93hn24M+zDnWEf7gz7cGfYhzvDPtwZ9uHOsA93hn24M+zDnWEf7gz7cGfYhzvDPtwZ9uHOsA93hn24M+zDnWEf7gz7cGfYhzvDPtwZ9uHOsA93hn24M+zDnWEf7gz7cGc4hDvDIdwZDuHOcAh3hkO4MxzCneEQ7gyHcGc4hDvDIdwZDuHOcAh3hkO4MxzCneEQ7gyHcGc4hDvDIdwZDuHOcAh3hkO4MxzCneEQ7gyHcGc4hDvDIdwZDuHOcAh3hkO4MxzCneEQ7gyHcGc4hDvDIdwZDuHOcAh3hkO4MxzCneEQ7gyHcGc4hDvDIdwZDuHOcAh3hkO4MxzCneEQ7gyHcGc4hDvDIdwZDuHOcAh3hkO4MxzCneEQ7gyHcGc4hDvDIdwZDuHOcAh3hkO4MxzCneEQ7gyHcGc4hDvDIdwZDuHOcAh3hkO4MxzCneEQ7gyHcGc4hDvDIdwZDuHOcAh3hkO4MxzCneEQ7gyHcGc4hDvDIdwZDuHOcAh3hkO4MxzCneEQ7gyHcGc4hDvDIdwZDuHOcAh3hkO4MxzCneEQ7gyHcGc4hDvDIdwZDuHOcAh3hpfPwqHh+6XRW/p+afSavl8avafvl370oj799j+//PK70xffffHH33/15Tf/8eXxy7/+9dvf/Onrv//t+yWbT97ob7758t//8Mm/vf7u3z58CfuFH19/d/wl/7fVy++Oq5df/Jbvt3z/Yccvfcvq+29ZfXh9/3pRf/z9n7/54h9/+dt//Oab3/3lz3/45Jvrn3/4Ifzj62/+z4cfxh//P1BLBwi+JNavzzsAAHFsAgBQSwMEFAAICAgAXEN+WwAAAAAAAAAAAAAAACMAAAB4bC93b3Jrc2hlZXRzL19yZWxzL3NoZWV0MS54bWwucmVsc43PSwrCMBAG4BN4hzB7k9aFiDTtRoRupR5gSKYPbB4k8dHbm42i4MLlzM98w181DzOzG4U4OSuh5AUwssrpyQ4Szt1xvQMWE1qNs7MkYaEITb2qTjRjyjdxnHxkGbFRwpiS3wsR1UgGI3eebE56FwymPIZBeFQXHEhsimIrwqcB9ZfJWi0htLoE1i2e/rFd30+KDk5dDdn044XQAe+5WCYxDJQkcP7avcOSZxZEXYmvivUTUEsHCK2o602zAAAAKgEAAFBLAwQUAAgICABcQ35bAAAAAAAAAAAAAAAAGAAAAHhsL3dvcmtzaGVldHMvc2hlZXQyLnhtbL2d3XLbVpZGn2DeQaWLuUosnX/QY7vLCWBQBAEQTjq5Zst0rIokuik5Tvrph5JJGfICxK+npvomUpY3zs8+UOJvERRf/O3Pq8ujP1abm4v19ctj8+z0+Gh1fb5+d3H928vjv//85vvs+Ojmdnn9bnm5vl69PP5rdXP8t1f/9eLzevP7zYfV6vZoO8D1zcvjD7e3H5+fnNycf1hdLW+erT+urrd/8n69uVrebv9189vJzcfNavnu/qKryxN7ehpPrpYX18dfRni+UcZYv39/cb7K1+efrlbXt18G2awul7fb5d98uPh4sx/t6k8Md3VxvlnfrN/fPjtfX+1G2q7g/GT15/nqfkHZowVdnSsrulpufv/08fvtkB+3q/jHxeXF7V/363oY5o+Xx5821893Y3z/sIy7a55v53/+x9XlvvhP47V1o5mTk8mj1f9pwv9tJHN6Ysw3Q/kle6Eva3n+MNKVNszDiexukVcv7odcbF69WH+6vby4Xi02RzefrrbN/+uH1eX688vj7Y27A28vfvtwewdOXr04ebju/ptfLlafb3rfH93dxv9Yr3+/+5ezd3cXvXrxcXm9Ovrrp4/bk9z9RNyuP85X729/XF1evjx+bY+Plue3F3+sFsu7n4h/rG9v11d3f37/k3K7Re8363+tru/mv1ldrs7vbs7dJV+G+MFtS/+5Wb3/8u3Hb8d5WPjdsvrf79f+5v4G3Pbg/NPN9qLp6suWzfHRu9X75afL2x/Xl79evLv9sGX2WXQP/O3680NxeHbfovP15c39P3eD7a87Prq6uP7ydfnn/dfPuz9Jz7Jsd+XwNXZ3jf16jTl0jdtd475ec/rMuCev8btr/Ndr7KFrwu6a8HDNwe3E3SWxv7Tw5CVpd0l6uMTaQ9Nku2uyr9O4hyMavmSyu2TSb8DTl5jT/YGe9k/HPb0283AbfL0PrHuWnu6C2d8IpncnxLv78cmr9reCcf25Dl21vxnM17vBmQPHZPZ3g/l6O9jTg83Y3xDm6x1hzcEF7u8J8/WmMJMvCzz58kN4/7OdL2+Xr15s1p+PNvcX735Wt63GT/t2trui19uq7f+BzfbG2eKbLf7jlXtx8sfduLuSHwZKssclP+5KJr2SyeOS/EuJPe2VmNPHNcVQjX1c82ao5psVlwPLMf5xzXQ3junXpMc1ZwM19ps1z4Zqvtl7taux/SZ/s6/5UM03+6qHar7ZVzNUEx7XtLsa16+Jj2sWQ+N8c+zd0Dhf936yvREf7kYr3Y32y4D+/qfh/ubbkfBAfgTJQYodiQ/kDUi5I+mBTHckeyBnOzJ5IDPUVCBzkBqkAWmxiwXW3PVrHrXXSe11aK9De0FykMKhvSClQ3sd2uvQXtRUIHPMVaOmAWmxiwXG6dxYe73UXo/2erQXJAcpPNoLUnq016O9Hu1FTQUyB6lBGpAWu1hgzZ0fa2+Q2hvQ3oD2guQgRUB7QcqA9ga0N6C9qKlA5pirRk0D0mIXC4zThbH2Rqm9Ee2NaC9IDlJEtBekjGhvRHsj2ouaCmQOUoM0IC12scCauzjW3iS1N6G9Ce0FyUGKhPaClAntTWhvQntRU4HMMVeNmgakxS4WGKdLY+3NpPZmaG+G9oLkIEWG9oKUGdqbob0Z2ouaCmQOUoM0IC12scCau2ysvROpvRO0d4L2guQgxQTtBSknaO8E7Z2gvaipQOaYq0ZNA9JiFwuM003G2nsXlZUYdooG71Gvw0Q5UbFHvSYTlXvUa/Me9fq8R71Gs6oimhPVRA1Ryw0tuPruUdXjhou517Dhhg0HyomKPeo3HKjco37DDRtu2HBUVURzzlizqiFquaEFx+oeVT1uuBbtDLOdYbgjyokKw3xHVBomPMOIZ5jxWFURzYlqooao5YYWXH1nRrOe0cKeYdozjHtEOVFhmPiISsPMZxj6DFMfqyqiOWesWdUQtdzQgmN1ZjT9GS3+GeY/wwBIlBMVhhmQqDRMgYYx0DAHsqoimhPVRA1Ryw0tuPrOjOZBowVCw0RoGAmJcqLCMBUSlYa50DAYGiZDVlVEc85Ys6oharmhBcfqzGhCNFpENMyIhiGRKCcqDHMiUWmYFA2jomFWZFVFNCeqiRqilhtacPWdGc2MRguNhqnRMDYS5USFYXIkKg2zo2F4NEyPrKqI5pyxZlVD1HJDC47VmdEUabQYaZgjDYMkUU5UGGZJotIwTRrGScM8yaqKaE5UEzVELTe04Oo7M5orjRYsDZOlYbQkyokKw3RJVBrmS8OAaZgwWVURzTljzaqGqOWGFhyrM6NJ02pJ0zJpWiZNopyosEyaRKVl0rRMmpZJk1UV0ZyoJmqIWm5owdV3djRpWi1pWiZNy6RJlBMVlkmTqLRMmpZJ0zJpsqoimnPGmlUNUcsNLThWZ0eTphVfRBx4FXHgZcSB1xEHXkgceCVx4KXEgdcSB15MHHg1ceDlxIHXEwdeUBx4RXHgJcWB1xQHXlQcTZpWS5qWSdMyaRLlRIVl0iQqLZOmZdK0TJqsqojmnLFmVUPUckMLjtXZ0aRptaRpmTQtkyZRTlRYJk2i0jJpWiZNy6TJqopoTlQTNUQtN7Tg6js7mjStljQtk6Zl0iTKiQrLpElUWiZNy6RpmTRZVRHNOWPNqoao5YYWHKuzo0nTaknTMmlaJk2inKiwTJpEpWXStEyalkmTVRXRnKgmaohabmjB1Xd2NGlaLWlaJk3LpEmUExWWSZOotEyalknTMmmyqiKac8aaVQ1Ryw0tOFZnR5Om1ZKmZdK0TJpEOVFhmTSJSsukaZk0LZMmqyqiOVFN1BC13NCCq+/saNK0WtK0TJqWSZMoJyoskyZRaZk0LZOmZdJkVUU054w1qxqilhtacKzOjiZNpyVNx6TpmDSJcqLCMWkSlY5J0zFpOiZNVlVEc6KaqCFquaEFV9+50aTptKTpmDQdkyZRTlQ4Jk2i0jFpOiZNx6TJqopozhlrVjVELTe04FidG02aTkuajknTMWkS5USFY9IkKh2TpmPSdEyarKqI5kQ1UUPUckMLrr5zo0nTiQ+wDjzBOvAI68AzrAMPsQ48xTrwGOvAc6wDD7IOPMk68CjrwLOsAw+zDjzNOvA468DzrAMPtI4mTaclTcek6Zg0iXKiwjFpEpWOSdMxaTomTVZVRHOimqgharmhBVffudGk6bSk6Zg0HZMmUU5UOCZNotIxaTomTcekyaqKaM4Za1Y1RC03tOBYnRtNmk5Lmo5J0zFpEuVEhWPSJCo549QxaRLNiKodcqe9hgPVRA1Ru0em13AmTTeaNJ2WNB2TpmPSJMqJCsekSVRyxqlj0iSaEVU79KjhQDVRQ9TuUb/hTJpuNGk6LWk6Jk3HpEmUExWOSZOo5IxTx6RJNCOqduhRw4Fqooao3aN+w5k03WjSdFrSdEyajkmTKCcqHJMmUckZp45Jk2hGVO3Qo4YD1UQNUbtH/YYzabrRpOm1pOmZND2TJlFOVHgmTaKSM049kybRjKjaoX7DiWqihqjdo17DufrOjyZNryVNz6TpmTSJcqLCM2kSlZxx6pk0iWZE1Q49ajhQTdQQtXvUbziTph9Nml5Lmp5J0zNpEuVEhWfSJCo549QzaRLNiKodetRwoJqoIWr3qN9wJk0/mjS9ljQ9k6Zn0iTKiQrPpElUcsapZ9IkmhFVO/So4UA1UUPU7lG/4UyafjRpevHNkwPvnhx4++TA+ycH3kA58A7KgbdQYsapZ9IkmhFVO/So4UA1UUPU7lG/4QNvphxNml5Lmp5J0zNpEuVEhWfSJCo549QzaRLNiKodetRwoJqoIWr3qN9wJk0/mjS9ljQ9k6Zn0iTKiQrPpElUcsapZ9IkmhFVnkmTqCZqiFrPpMnVd340aXotaXomTc+kSZQTFZ5Jk6jkjFPPpEk0I6o8kyZRTdQQtZ5Jk6vv/GjS9FrS9EyankmTKCcqPJMmUckZp55Jk2hGVHkmTaKaqCFqPZMmV9/50aTptaTpmTQ9kyZRTlR4Jk2ikjNOPZMm0Yyo8kyaRDVRQ9R6Jk2uvvOjSTNoSTMwaQYmTaKcqAhMmkQlZ5wGJk2iGVEVmDSJaqKGqA1Mmlx9F0aTZtCSZmDSDEyaRDlREZg0iUrOOA1MmkQzoiowaRLVRA1RG5g0ufoujCbNoCXNwKQZmDSJcqIiMGkSlZxxGpg0iWZEVWDSJKqJGqI2MGly9V0YTZpBS5qBSTMwaRLlREVg0iQqOeM0MGkSzYiqwKRJVBM1RG1g0uTquzCaNIOWNAOTZmDSJMqJisCkSVRyxmlg0iSaEVWBSZOoJmqI2sCkydV3YTRpBi1pBibNwKRJlBMVgUmTqOSM08CkSTQjqgKTJlFN1BC1gUmTq+/CaNIMWtIMTJqBSZMoJyoCkyZRyRmngUmTaEZUBSZNopqoIWoDkyZX34XRpBm0pBmYNAOTJlFOVAQmTaKSM04DkybRjKgKTJpENVFD1AYmTa6+C6NJM2hJMzBpBiZNopyoCEyaRCVnnAYmTaIZURWYNIlqooaoDUyaXH0XRpNm0JJmYNIMTJpEOVERmDSJSs44DUyaRDOiKjBpEtVEDVEbmDS5+i6MJs2oJc3IpBmZNIlyoiIyaRKVnHEamTSJZkRVZNIkqokaojYyaXL1XRxNmlFLmpFJMzJpEuVERWTSJCo54zQyaRLNiKrIpElUEzVEbWTS5Oq7OJo0o5Y0I5NmZNIkyomKyKRJVHLGaWTSJJoRVZFJk6gmaojayKTJ1XdxNGlGLWlGJs3IpEmUExWRSZOo5IzTyKRJNCOqIpMmUU3UELWRSZOr7+Jo0oxPJ82Tr4VPJ6Re4dN/s+8VPv030l7h03+T6hU+/TeAr4Xp6f9z9Qqf/i9ur/Dp/1L0Cp++w3uF6skk9WSSejJJPZmknkxSTyZTTyZTTyZTTyZTTyZTTyZTTyZTTyZTTyZTTyZTT2ainsxEPZmJejIT9WQm6slM1JOZqCczUU9mop7MRD0Zc6oejTlVz8acqodjTtXTMafq8ZhT9XzMqXpA5lQ9IXOqHpE5lc/owK9P7VfKZ3TgF1b2K+UzOvArAvuV8hkd+KVs/Ur5jA78Gqx+pXxGB37xUL9SPqMDv+qlXymf0YFfrtGvlM/Iymd04H34/Ur5jA6887lX6eQzOvBe036lfEYH3t3Xr5TP6MD7qfqV8hkdeAdLv1I+owPvGehVHnjYvV8pn9GBx4v7lfIZHXigs18pn9GBR+j6lfIZHXhoqV8pn9GBx0T6lfIZHXhhvl8pn9GBl0L7lfIZHXjxqV8pn9EB3d+vlM/ogGDtV8pndEBp9SvlM5IlgpEtgpE1gpE9gpFFgpFNgpFVgpFdgpFlgpFtgpF1gpF9gpGFgpGNgpGVgpGdgpGlgpGtgpG1gpG9gpHFgpHNgpHVgpHdgpHlgpHtgpH1gpH9gpEFg5ENg5EVg5Edg5Elg5Etg5E1g5E9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5U9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5M9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9g5c9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9Q5A9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";

let records = JSON.parse(localStorage.getItem('rbiRecords')) || [];
let households = JSON.parse(localStorage.getItem('rbiHouseholds')) || [];
let settings = JSON.parse(localStorage.getItem('rbi_settings')) || { 
    custom_password: '', 
    addresses: [],
    location_config: { type: 'PUROK', naming: 'NUMBER' }
};

let currentGlobalPurok = localStorage.getItem('globalPurok') || "1";
let editingIndex = -1; 
let hhPage = 1;
let recPage = 1;
let currentEditingHH = null; 
let tempHHMembers = []; 
let promptCallback = null;
let confirmCallback = null;
let currentExportFile = null;

let tempLocType = 'PUROK';
let tempLocName = 'NUMBER';

const TABS = ['reg', 'rec', 'hh', 'conf'];
let currentTab = 'reg';

// --- TOUCH LOGIC ---
let touchStartX = 0;
let touchEndX = 0;

document.addEventListener('touchstart', e => { touchStartX = e.changedTouches[0].screenX; });
document.addEventListener('touchend', e => { 
    touchEndX = e.changedTouches[0].screenX;
    const threshold = 50; 
    if (touchEndX < touchStartX - threshold) changeTabByOrder(1);
    if (touchEndX > touchStartX + threshold) changeTabByOrder(-1);
});

function changeTabByOrder(dir) {
    const currentIndex = TABS.indexOf(currentTab);
    let nextIndex = currentIndex + dir;
    if(nextIndex < 0) nextIndex = 0;
    if(nextIndex >= TABS.length) nextIndex = TABS.length - 1;
    if(nextIndex !== currentIndex) switchTab(TABS[nextIndex], dir);
}

// --- UTILS ---
function showToast(msg, type = 'info') {
    const box = document.createElement('div');
    box.className = `toast ${type}`;
    let icon = type === 'success' ? '<i class="fas fa-check-circle"></i>' : (type === 'error' ? '<i class="fas fa-exclamation-circle"></i>' : '<i class="fas fa-info-circle"></i>');
    box.innerHTML = `${icon} <span>${msg}</span>`;
    document.getElementById('toast-container').appendChild(box);
    setTimeout(() => { box.style.opacity = '0'; setTimeout(() => box.remove(), 300); }, 3000);
}

function showLoading(show, title="PROCESSING...", desc="Please wait.") {
    document.getElementById('loading-title').innerText = title;
    document.getElementById('loading-desc').innerText = desc;
    document.getElementById('loading-modal').style.display = show ? 'flex' : 'none';
}

function showCustomPrompt(title, msg, callback) {
    document.getElementById('prompt-title').innerText = title;
    document.getElementById('prompt-msg').innerText = msg;
    document.getElementById('prompt-input').value = '';
    document.getElementById('custom-prompt-modal').style.display = 'flex';
    document.getElementById('prompt-input').focus();
    promptCallback = callback;
}
function submitPromptModal() {
    const val = document.getElementById('prompt-input').value;
    document.getElementById('custom-prompt-modal').style.display = 'none';
    if(promptCallback) promptCallback(val);
}
function closePromptModal() { document.getElementById('custom-prompt-modal').style.display = 'none'; }

function showCustomConfirm(title, msg, callback) {
    document.getElementById('confirm-title').innerText = title;
    document.getElementById('confirm-msg').innerText = msg;
    document.getElementById('custom-confirm-modal').style.display = 'flex';
    confirmCallback = callback;
}
function executeConfirmAction() {
    document.getElementById('custom-confirm-modal').style.display = 'none';
    if(confirmCallback) confirmCallback();
}
function closeConfirmModal() { document.getElementById('custom-confirm-modal').style.display = 'none'; }

// --- AUTH ---
function getDynamicPassword() {
    const now = new Date();
    const y = now.getFullYear();
    const onejan = new Date(y, 0, 1);
    const w = Math.ceil((((now - onejan) / 86400000) + onejan.getDay() + 1) / 7);
    return `RBI-${now.getMonth()}${now.getDate()}${y}${w*2}`;
}

window.onload = function() {
    let fixedCount = 0;
    records.forEach(r => {
        if (r[17] === null || r[17] === undefined || r[17] === "" || r[17] === "null") {
            r[17] = currentGlobalPurok;
            fixedCount++;
        }
    });
    if(fixedCount > 0) {
        localStorage.setItem('rbiRecords', JSON.stringify(records));
        console.log(`Auto-fixed ${fixedCount} records with null location.`);
    }

    if(!settings.custom_password) document.getElementById('login-msg').innerText = "Create Your Password to Start";
    
    if(!settings.location_config) settings.location_config = { type: 'PUROK', naming: 'NUMBER' };
    
    updateMotherDatalist(); loadConfigUI(); updateGlobalPurokUI();
}

function attemptLogin() {
    const input = document.getElementById('login-pass').value.trim(); 
    const dynamicMaster = getDynamicPassword();

    if (!settings.custom_password) {
        if(input.length > 0) {
            settings.custom_password = input;
            saveSettings(); showToast("Password Set! Logged in.", "success");
            document.getElementById('login-overlay').style.display = 'none';
        } else showToast("Create a password.", "error");
        return;
    }

    if (input === settings.custom_password || input.toUpperCase() === dynamicMaster) {
        document.getElementById('login-overlay').style.display = 'none';
    } else {
        showToast("Incorrect Password.", "error");
    }
}

function forgotPassword() {
    showCustomPrompt("ADMIN RECOVERY", "Enter Dynamic Admin Code:", (code) => {
        const dynamicMaster = getDynamicPassword();
        if(code && code.trim().toUpperCase() === dynamicMaster) {
            setTimeout(() => {
                showCustomPrompt("RESET PASSWORD", "Enter New Password:", (newPass) => {
                    if(newPass && newPass.trim().length > 0) {
                        settings.custom_password = newPass.trim();
                        saveSettings(); showToast("Password Reset Successfully.", "success");
                    }
                });
            }, 500);
        } else if(code) {
            showToast("Invalid Code.", "error");
        }
    });
}

function saveSettings() { localStorage.setItem('rbi_settings', JSON.stringify(settings)); }

// --- UI LOGIC ---
function updateGlobalPurokUI() {
    const type = settings.location_config.type;
    const labelSpan = document.getElementById('globalLabel');
    const badge = document.getElementById('globalPurokDisplay');

    if(type === 'NONE') {
        labelSpan.innerText = "LOCATION";
        badge.innerText = "N/A";
    } else {
        labelSpan.innerText = type;
        badge.innerText = currentGlobalPurok;
    }
    
    localStorage.setItem('globalPurok', currentGlobalPurok);
}

function openLocationModal() {
    tempLocType = settings.location_config.type;
    tempLocName = settings.location_config.naming;
    
    selectLocType(tempLocType);
    selectLocName(tempLocName);
    
    const input = document.getElementById('loc-input-val');
    input.value = currentGlobalPurok;
    
    if(tempLocType === 'NONE') input.disabled = true;
    else input.disabled = false;

    document.getElementById('location-settings-modal').style.display = 'flex';
}

function closeLocationModal() {
    document.getElementById('location-settings-modal').style.display = 'none';
}

function selectLocType(type) {
    tempLocType = type;
    document.getElementById('opt-type-purok').classList.toggle('selected', type === 'PUROK');
    document.getElementById('opt-type-sitio').classList.toggle('selected', type === 'SITIO');
    document.getElementById('opt-type-none').classList.toggle('selected', type === 'NONE');

    const nameGroup = document.getElementById('group-naming');
    const input = document.getElementById('loc-input-val');

    if (type === 'NONE') {
        nameGroup.style.opacity = '0.5'; nameGroup.style.pointerEvents = 'none';
        input.disabled = true; input.value = "N/A";
    } else {
        nameGroup.style.opacity = '1'; nameGroup.style.pointerEvents = 'all';
        input.disabled = false;
        if(input.value === "N/A") input.value = "";
    }
}

function selectLocName(nameType) {
    tempLocName = nameType;
    document.getElementById('opt-name-num').classList.toggle('selected', nameType === 'NUMBER');
    document.getElementById('opt-name-txt').classList.toggle('selected', nameType === 'NAME');
    
    const input = document.getElementById('loc-input-val');
    if (tempLocType !== 'NONE') {
        input.type = (nameType === 'NUMBER') ? 'number' : 'text';
    }
}

function saveLocationSettings() {
    const inputVal = document.getElementById('loc-input-val').value.trim();
    
    if (tempLocType !== 'NONE' && !inputVal) {
        showToast("Please enter a value", "error");
        return;
    }

    const oldContext = currentGlobalPurok;
    
    let newContext = "";
    if (tempLocType !== 'NONE') {
        newContext = inputVal.toUpperCase();
    } else {
        newContext = "N/A";
    }

    if(oldContext && oldContext !== newContext) {
        const recordsToUpdate = records.filter(r => r[17] === oldContext).length;
        
        if(recordsToUpdate > 0) {
            closeLocationModal();
            showCustomConfirm(
                "BATCH UPDATE?", 
                `Found ${recordsToUpdate} records in "${oldContext}".\nMove them to "${newContext}"?`, 
                () => {
                    applyLocationUpdate(newContext, true, oldContext); 
                }
            );
        } else {
            applyLocationUpdate(newContext, false, null);
        }
    } else {
        applyLocationUpdate(newContext, false, null);
    }
}

function applyLocationUpdate(newContext, isBatch, oldContext) {
    settings.location_config.type = tempLocType;
    settings.location_config.naming = tempLocName;
    currentGlobalPurok = newContext;
    saveSettings();
    updateGlobalPurokUI();

    if(isBatch && oldContext) {
        let count = 0;
        records.forEach(r => {
            if(r[17] === oldContext) {
                r[17] = newContext;
                count++;
            }
        });
        localStorage.setItem('rbiRecords', JSON.stringify(records));
        showToast(`Updated ${count} records to ${newContext}`, "success");
        if(currentTab === 'rec') renderList();
    } else {
        showToast("Location Context Updated", "success");
    }

    closeLocationModal();
}

function loadConfigUI() {
    const sel = document.getElementById('addressSelect');
    sel.innerHTML = '<option value="">SELECT ADDRESS...</option>';
    (settings.addresses || []).forEach(addr => {
        let opt = document.createElement('option'); opt.value = addr; opt.innerText = addr; sel.appendChild(opt);
    });
    const list = document.getElementById('listAddresses');
    list.innerHTML = '';
    (settings.addresses || []).forEach((addr, i) => {
        list.innerHTML += `<div class="config-item"><span>${addr}</span> <i class="fas fa-trash" style="color:red; cursor:pointer;" onclick="removeAddress(${i})"></i></div>`;
    });
}

function addAddress() {
    const val = document.getElementById('newAddress').value.toUpperCase().trim();
    if(val) {
        if(!settings.addresses) settings.addresses = [];
        settings.addresses.push(val);
        saveSettings(); document.getElementById('newAddress').value = ""; loadConfigUI();
    }
}
function removeAddress(i) {
    showCustomConfirm("DELETE ADDRESS", "Remove this address from list?", () => {
        settings.addresses.splice(i, 1); saveSettings(); loadConfigUI();
    });
}

function switchTab(tab, dir = 0) {
    currentTab = tab;
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    
    const contents = document.querySelectorAll('.content-area');
    contents.forEach(c => {
        c.classList.remove('active', 'slide-in-left', 'slide-in-right');
    });

    const activeContent = document.getElementById(`tab-${tab === 'reg' ? 'registration' : (tab === 'rec' ? 'records' : (tab === 'hh' ? 'households' : 'config'))}`);
    activeContent.classList.add('active');
    if(dir > 0) activeContent.classList.add('slide-in-right');
    else if(dir < 0) activeContent.classList.add('slide-in-left');

    document.getElementById(`btn-${tab}`).classList.add('active');
    if(tab === 'rec') renderList();
    if(tab === 'hh') renderHouseholdList();
}

function checkReligion() {
    const sel = document.getElementById('religionSelect');
    document.getElementById('religionOther').style.display = (sel.value === 'OTHERS') ? 'block' : 'none';
}

function checkCitizenship() {
    const sel = document.getElementById('citizenshipSelect');
    const input = document.getElementById('citizenshipOther');
    if(sel.value === 'FOREIGNER') {
        input.style.display = 'block';
    } else {
        input.style.display = 'none';
    }
}

function saveRecord(){
  const idsToCheck = ['lastName', 'firstName', 'birthPlace', 'birthDate', 'addressSelect'];
  for(let id of idsToCheck) {
      if(!document.getElementById(id).value.trim()) { showToast("FIELD REQUIRED: " + id.toUpperCase(), "error"); return; }
  }
  
  let finalReligion = document.getElementById('religionSelect').value;
  if(finalReligion === 'OTHERS') {
      finalReligion = document.getElementById('religionOther').value.toUpperCase();
      if(!finalReligion) { showToast("SPECIFY RELIGION", "error"); return; }
  }

  let finalCitizenship = document.getElementById('citizenshipSelect').value;
  if(finalCitizenship === 'FOREIGNER') {
      finalCitizenship = document.getElementById('citizenshipOther').value.toUpperCase();
      if(!finalCitizenship) { showToast("SPECIFY NATIONALITY", "error"); return; }
  }
  
  let purokToSave = currentGlobalPurok;
  
  const newRow = [
    document.getElementById('inhabitantType').value, document.getElementById('lastName').value.toUpperCase(),
    document.getElementById('firstName').value.toUpperCase(), document.getElementById('middleName').value.toUpperCase(),
    document.getElementById('suffix').value.toUpperCase(), document.getElementById('birthPlace').value.toUpperCase(),
    document.getElementById('birthDate').value, document.getElementById('sex').value, document.getElementById('civilStatus').value,
    finalCitizenship, document.getElementById('profession').value.toUpperCase(), 
    document.getElementById('contact').value, "", document.getElementById('education').value,
    document.getElementById('mFirst').value.toUpperCase(), document.getElementById('mMiddle').value.toUpperCase(),
    document.getElementById('mLast').value.toUpperCase(), purokToSave, document.getElementById('addressSelect').value, 
    finalReligion, document.getElementById('isOSY').checked ? "YES" : "NO", document.getElementById('isPWD').checked ? "YES" : "NO",
    document.getElementById('is4Ps').checked ? "YES" : "NO", document.getElementById('isIPS').checked ? "YES" : "NO",
    document.getElementById('isSolo').checked ? "YES" : "NO",
    document.getElementById('laborStatus').value,
    document.getElementById('isOFW').checked ? "YES" : "NO",
    document.getElementById('isISY').checked ? "YES" : "NO"
  ];

  if (editingIndex > -1) {
      records[editingIndex] = newRow; showToast('Record Updated to ' + purokToSave, "success"); cancelEdit(); 
  } else {
      records.push(newRow); showToast(`Saved to ${settings.location_config.type}: ${purokToSave}`, "success");
  }
  localStorage.setItem('rbiRecords', JSON.stringify(records)); updateMotherDatalist();

  if(editingIndex === -1) {
      const currType = document.getElementById('inhabitantType').value;
      document.querySelectorAll('input').forEach(i => { if(i.type === 'checkbox') i.checked = false; else i.value = ''; });
      document.getElementById('inhabitantType').value = currType; 
      
      document.getElementById('citizenshipSelect').value = "FILIPINO";
      checkCitizenship();

      document.getElementById('religionSelect').value = "ROMAN CATHOLIC"; 
      document.getElementById('addressSelect').value = "";
      checkReligion(); document.getElementById('lastName').focus();
  }
}

function startEdit(index) {
    const r = records[index];
    document.getElementById('inhabitantType').value = r[0]; document.getElementById('lastName').value = r[1];
    document.getElementById('firstName').value = r[2]; document.getElementById('middleName').value = r[3];
    document.getElementById('suffix').value = r[4]; document.getElementById('birthPlace').value = r[5];
    document.getElementById('birthDate').value = r[6]; document.getElementById('sex').value = r[7];
    document.getElementById('civilStatus').value = r[8]; 
    
    const citVal = r[9];
    if(citVal === 'FILIPINO') {
        document.getElementById('citizenshipSelect').value = 'FILIPINO';
    } else {
        document.getElementById('citizenshipSelect').value = 'FOREIGNER';
        document.getElementById('citizenshipOther').value = citVal;
    }
    checkCitizenship();

    document.getElementById('profession').value = r[10]; document.getElementById('contact').value = r[11];
    document.getElementById('education').value = r[13]; document.getElementById('mFirst').value = r[14];
    document.getElementById('mMiddle').value = r[15]; document.getElementById('mLast').value = r[16];
    document.getElementById('addressSelect').value = r[18];

    const relVal = r[19] || "ROMAN CATHOLIC";
    const relSelect = document.getElementById('religionSelect');
    let exists = false;
    for(let i=0; i<relSelect.options.length; i++) if(relSelect.options[i].value === relVal) exists = true;
    if(exists) { relSelect.value = relVal; document.getElementById('religionOther').style.display = 'none'; } 
    else { relSelect.value = 'OTHERS'; document.getElementById('religionOther').style.display = 'block'; document.getElementById('religionOther').value = relVal; }

    document.getElementById('isOSY').checked = (r[20] === "YES"); document.getElementById('isPWD').checked = (r[21] === "YES");
    document.getElementById('is4Ps').checked = (r[22] === "YES"); document.getElementById('isIPS').checked = (r[23] === "YES");
    document.getElementById('isSolo').checked = (r[24] === "YES");
    
    document.getElementById('laborStatus').value = r[25] || "EMPLOYED";
    document.getElementById('isOFW').checked = (r[26] === "YES");
    document.getElementById('isISY').checked = (r[27] === "YES");

    editingIndex = index;
    document.getElementById('btn-save').innerHTML = '<i class="fas fa-check"></i> UPDATE RECORD';
    document.getElementById('btn-cancel').style.display = "flex";
    document.getElementById('edit-banner').style.display = "block";
    
    const currentLoc = currentGlobalPurok;
    const recordLoc = r[17];
    
    let msg = `Original: ${recordLoc}`;
    if(recordLoc !== currentLoc) {
        msg += ` <i class="fas fa-arrow-right"></i> <strong style="color:white; text-decoration:underline;">Saving will move to: ${currentLoc}</strong>`;
    }
    document.getElementById('edit-location-msg').innerHTML = msg;
    
    closeViewer(); switchTab('reg');
}

function cancelEdit() {
    editingIndex = -1;
    document.getElementById('btn-save').innerHTML = '<i class="fas fa-save"></i> SAVE RECORD';
    document.getElementById('btn-cancel').style.display = "none"; document.getElementById('edit-banner').style.display = "none";
    document.querySelectorAll('input').forEach(i => { if(i.type === 'checkbox') i.checked = false; else i.value = ''; });
    document.getElementById('addressSelect').value = ""; 
    document.getElementById('citizenshipSelect').value = "FILIPINO"; checkCitizenship();
    document.getElementById('religionSelect').value = "ROMAN CATHOLIC"; checkReligion();
}

function renderList(){
  const q = document.getElementById('searchBox').value.toLowerCase();
  const list = document.getElementById('resultList'); list.innerHTML = '';
  
  let filtered = records.map((r, i) => ({data: r, index: i})).filter(item => item.data[1].toLowerCase().includes(q) || item.data[2].toLowerCase().includes(q));

  const itemsPerPage = 7;
  const totalPages = Math.ceil(filtered.length / itemsPerPage) || 1;
  if(recPage > totalPages) recPage = totalPages; if(recPage < 1) recPage = 1;

  document.getElementById('rec-page-indicator').innerText = `Page ${recPage} of ${totalPages}`;
  document.getElementById('btn-prev-rec').className = `page-btn ${recPage===1?'disabled':''}`;
  document.getElementById('btn-next-rec').className = `page-btn ${recPage===totalPages?'disabled':''}`;

  const pageItems = filtered.slice((recPage - 1) * itemsPerPage, (recPage - 1) * itemsPerPage + itemsPerPage);

  if(pageItems.length === 0) { list.innerHTML = '<div style="text-align:center; padding:30px; color:#94a3b8; font-style:italic;">NO RECORDS FOUND</div>'; return; }
  
  pageItems.forEach((item) => {
    const r = item.data; 
    const div = document.createElement('div'); div.className = 'record-card';
    div.onclick = () => viewRecord(item.index); 
    
    let genderIcon = r[7] === 'MALE' ? '<i class="fas fa-mars" style="color:var(--male);"></i>' : '<i class="fas fa-venus" style="color:var(--female);"></i>';
    
    div.innerHTML = `
        <div style="display:flex; align-items:center; gap:15px;">
            <div style="background:#f1f5f9; padding:10px; border-radius:50%; width:40px; height:40px; display:flex; align-items:center; justify-content:center;">${genderIcon}</div>
            <div><h5 style="font-size:15px;">${r[1]}, ${r[2]} ${r[4]}</h5><p style="margin-top:2px;">${r[17]}</p></div>
        </div>
        <i class="fas fa-chevron-right" style="color:#cbd5e1; font-size:14px;"></i>
    `;
    list.appendChild(div);
  });
}
function changeRecPage(dir) { recPage += dir; renderList(); }

function viewRecord(index) {
    const r = records[index];
    const html = HEADERS_RBIS.map((h, i) => `<div style="border-bottom:1px solid #f1f5f9; padding:12px 0;"><span style="font-size:10px; color:#94a3b8; display:block; font-weight:700; letter-spacing:0.5px;">${h}</span><span style="font-size:15px; font-weight:600; color:#334155;">${r[i] || '-'}</span></div>`).join('');
    document.getElementById('viewer-content').innerHTML = html;
    document.getElementById('viewer-actions').innerHTML = `<button class="btn btn-warning" onclick="startEdit(${index})" style="background:#f59e0b; color:white; box-shadow:0 4px 12px rgba(245, 158, 11, 0.4);">EDIT RECORD</button><button class="btn btn-ghost" onclick="closeViewer()">CLOSE</button>`;
    document.getElementById('viewer-overlay').style.display = 'flex';
}
function closeViewer() { document.getElementById('viewer-overlay').style.display = 'none'; }

function openHHModal(index = -1) {
    document.getElementById('hh-modal').style.display = 'flex';
    document.getElementById('hh-pred-list').style.display = 'none';
    document.getElementById('hh-member-search').value = '';
    
    if(index > -1) { 
        currentEditingHH = households[index];
        tempHHMembers = currentEditingHH.members.map(m => {
            if(typeof m === 'object') return m; 
            return { index: m, role: "MEMBER" }; 
        });
        document.getElementById('hh-id-input').value = currentEditingHH.id;
    } else { 
        currentEditingHH = null; tempHHMembers = []; document.getElementById('hh-id-input').value = "";
    }
    renderHHMembersPreview();
}
function closeHHModal() { document.getElementById('hh-modal').style.display = 'none'; }

function searchMemberForHH() {
    const val = document.getElementById('hh-member-search').value.toLowerCase();
    const list = document.getElementById('hh-pred-list'); list.innerHTML = '';
    if(val.length < 2) { list.style.display = 'none'; return; }

    const occupiedIndices = new Set();
    households.forEach(hh => {
        if(currentEditingHH && hh === currentEditingHH) return;
        hh.members.forEach(m => {
             let idx = (typeof m === 'object') ? m.index : m;
             occupiedIndices.add(idx);
        });
    });

    const matches = records.map((r, i) => ({name: `${r[1]}, ${r[2]}`, index: i}))
                         .filter(m => m.name.toLowerCase().includes(val));
    const finalMatches = matches.filter(m => !occupiedIndices.has(m.index));

    if(finalMatches.length > 0) {
        list.style.display = 'block';
        finalMatches.slice(0, 5).forEach(m => {
            const li = document.createElement('li'); li.className = 'pred-item'; li.innerText = m.name;
            li.onclick = () => addMemberToHH(m.index); list.appendChild(li);
        });
    } else list.style.display = 'none';
}

function addMemberToHH(recordIndex) {
    if(!tempHHMembers.some(m => m.index === recordIndex)) {
        tempHHMembers.push({ index: recordIndex, role: "MEMBER" }); 
        renderHHMembersPreview();
        document.getElementById('hh-member-search').value = ''; document.getElementById('hh-pred-list').style.display = 'none';
    } else showToast("Person already in this list.", "error");
}

function updateMemberRole(tempIndex, newRole) {
    tempHHMembers[tempIndex].role = newRole;
}

function removeMemberFromHH(tempIndex) {
    tempHHMembers.splice(tempIndex, 1); renderHHMembersPreview();
}

function renderHHMembersPreview() {
    const div = document.getElementById('hh-members-display'); div.innerHTML = '';
    if(tempHHMembers.length === 0) { div.innerHTML = '<small style="color:#94a3b8; font-style:italic;">No members added yet.</small>'; return; }
    
    tempHHMembers.forEach((mObj, i) => {
        const r = records[mObj.index];
        if(r) {
            const roles = ["MEMBER", "HEAD OF HOUSEHOLD", "SPOUSE", "SON", "DAUGHTER", "OTHERS"];
            let roleOptions = roles.map(role => `<option value="${role}" ${mObj.role===role?'selected':''}>${role}</option>`).join('');
            
            div.innerHTML += `
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; border-bottom:1px solid #f1f5f9; padding-bottom:8px;">
                <div style="flex:1;">
                    <div style="font-weight:700; font-size:13px; color:#334155;">${r[1]}, ${r[2]}</div>
                    <select onchange="updateMemberRole(${i}, this.value)" style="padding:6px; font-size:11px; margin-top:4px; width:95%; border:1px solid #cbd5e1; border-radius:6px;">${roleOptions}</select>
                </div>
                <i class="fas fa-times" style="color:#ef4444; cursor:pointer; padding:8px; background:#fee2e2; border-radius:50%; width:24px; height:24px; display:flex; align-items:center; justify-content:center; font-size:12px;" onclick="removeMemberFromHH(${i})"></i>
            </div>`;
        }
    });
}

function saveHousehold() {
    const hhID = document.getElementById('hh-id-input').value.trim();
    if(!hhID) { showToast("Household Number required", "error"); return; }
    if(tempHHMembers.length === 0) { showToast("Add at least one member", "error"); return; }

    if(currentEditingHH) { currentEditingHH.id = hhID; currentEditingHH.members = tempHHMembers; showToast("Household Updated", "success"); } 
    else { households.push({ id: hhID, members: tempHHMembers }); showToast("Household Created", "success"); }
    
    localStorage.setItem('rbiHouseholds', JSON.stringify(households)); closeHHModal(); renderHouseholdList();
}

function renderHouseholdList() {
    const container = document.getElementById('hh-list-container');
    const search = document.getElementById('searchHH').value.toLowerCase();
    container.innerHTML = '';
    
    let filtered = households.filter(hh => {
        if(hh.id.toLowerCase().includes(search)) return true;
        return hh.members.some(m => {
            let idx = (typeof m === 'object') ? m.index : m;
            const r = records[idx];
            return r && (r[1].toLowerCase().includes(search) || r[2].toLowerCase().includes(search));
        });
    });

    const itemsPerPage = 5; const totalPages = Math.ceil(filtered.length / itemsPerPage) || 1;
    if(hhPage > totalPages) hhPage = totalPages; if(hhPage < 1) hhPage = 1;
    
    document.getElementById('hh-page-indicator').innerText = `Page ${hhPage} of ${totalPages}`;
    document.getElementById('btn-prev-hh').className = `page-btn ${hhPage===1?'disabled':''}`;
    document.getElementById('btn-next-hh').className = `page-btn ${hhPage===totalPages?'disabled':''}`;

    const pageItems = filtered.slice((hhPage - 1) * itemsPerPage, (hhPage - 1) * itemsPerPage + itemsPerPage);
    if(pageItems.length === 0) { container.innerHTML = '<div style="text-align:center; padding:30px; color:#94a3b8; font-style:italic;">No Households Found</div>'; return; }

    pageItems.forEach(hh => {
        const realIndex = households.indexOf(hh);
        let heads = hh.members.filter(m => (typeof m === 'object' && m.role === 'HEAD OF HOUSEHOLD'));
        if(heads.length === 0 && hh.members.length > 0) heads = [hh.members[0]]; 
        
        let headNames = heads.map(h => {
             let idx = (typeof h === 'object') ? h.index : h;
             return records[idx] ? `${records[idx][1]}, ${records[idx][2]}` : "Unknown";
        }).join(" & ");

        const div = document.createElement('div'); div.className = 'record-card';
        div.onclick = () => openHHModal(realIndex);
        div.innerHTML = `<div><h5 style="color:var(--accent); font-weight:800;">HH: ${hh.id}</h5><p><b>Head:</b> ${headNames}</p><p style="font-size:11px; margin-top:2px;">Members: ${hh.members.length}</p></div><i class="fas fa-pencil-alt" style="color:#94a3b8;"></i>`;
        container.appendChild(div);
    });
}
function changeHHPage(dir) { hhPage += dir; renderHouseholdList(); }

function updateMotherDatalist() {
    const dl = document.getElementById('motherList'); dl.innerHTML = ''; const uniqueMothers = new Set();
    records.forEach(r => { if(r[16] && r[14]) { const k = `${r[16]}, ${r[14]}`; if(!uniqueMothers.has(k)){ uniqueMothers.add(k); const o = document.createElement('option'); o.value = `${r[16]}, ${r[14]} ${r[15] || ''}`.trim(); dl.appendChild(o); }}});
}
function autoFillMother(inputObj) {
    const val = inputObj.value; const found = records.find(r => `${r[16]}, ${r[14]} ${r[15] || ''}`.trim() === val);
    if(found) { document.getElementById('mLast').value = found[16]; document.getElementById('mFirst').value = found[14]; document.getElementById('mMiddle').value = found[15]; }
}

// --- EXPORT LOGIC ---
function openExportModal() {
    if(records.length === 0){ showToast("No records to export.", "error"); return; }
    document.getElementById('export-options-modal').style.display = 'flex';
}

function closeExportModal() {
    document.getElementById('export-options-modal').style.display = 'none';
}

function processExport(type) {
    closeExportModal();
    if(type === 'BOTH') {
        exportData('RBIS');
        setTimeout(() => exportData('BIMS'), 1500); 
    } else {
        exportData(type);
    }
}

function exportData(format) {
    showLoading(true, `GENERATING ${format}`, "Preparing File in Memory...");
    
    setTimeout(() => {
        try {
            let wb = XLSX.utils.book_new();
            let filename = `RBI_${format}_${new Date().toISOString().slice(0,10)}.xlsx`;

            if(format === 'RBIS') {
                const instructionData = [["INSTRUCTIONS"], ["Generated by RBI FIELD"], ["Full Data Export"]];
                XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(instructionData), "INSTRUCTIONS");
                const allData = [HEADERS_RBIS, ...records];
                XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(allData), "DATA");
            }
            // PATCH 3 & 4: BIMS — load the exact official template, inject records into DATA sheet.
            // Preserves all original formatting, styles, column widths, and INSTRUCTIONS sheet.
            // Only columns 1-17 are exported (BIMS does not accept extra columns).
            else if (format === 'BIMS') {
                wb = XLSX.read(BIMS_TEMPLATE_B64, { type: 'base64' });
                const dataWs = wb.Sheets['DATA'];
                // Validate DATA sheet exists (safety check)
                if (!dataWs) {
                    throw new Error("BIMS template is corrupted. DATA sheet not found.");
                }
                // Map records to BIMS columns (indices 0-16 only)
                const bimsRows = records.map(r => [
                    r[0] || "",   // INHABITANT TYPE
                    r[1] || "",   // LAST NAME
                    r[2] || "",   // FIRST NAME
                    r[3] || "",   // MIDDLE NAME
                    r[4] || "",   // SUFFIX
                    r[5] || "",   // BIRTH PLACE
                    r[6] || "",   // BIRTHDATE (YYYY-MM-DD)
                    r[7] || "",   // SEX
                    r[8] || "",   // CIVIL STATUS
                    r[9] || "",   // CITIZENSHIP
                    r[10] || "",  // PROFESSION/ OCCUPATION
                    r[11] || "",  // CONTACT NUMBER
                    r[12] || "",  // EMAIL ADDRESS
                    r[13] || "",  // HIGHEST EDUCATIONAL ATTAINMENT
                    r[14] || "",  // MOTHER'S FIRST NAME
                    r[15] || "",  // MOTHER'S MIDDLE NAME
                    r[16] || ""   // MOTHER'S LAST NAME
                ]);
                // Inject starting at row 2 (row 1 = header, already in template)
                XLSX.utils.sheet_add_aoa(dataWs, bimsRows, { origin: 'A2' });
                filename = `RBI_BIMS_Import_${new Date().toISOString().slice(0,10)}.xlsx`;
            }

            const wbout = XLSX.write(wb, {bookType:'xlsx', type:'array'});
            const blob = new Blob([wbout], {type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});
            const file = new File([blob], filename, {type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'});

            currentExportFile = file;

            showLoading(false);
            
            document.getElementById('share-modal').style.display = 'flex';
            
            const shareBtn = document.getElementById('btn-smart-share');
            const warnMsg = document.getElementById('protocol-warning');
            const fallbackInfo = document.getElementById('share-fallback-info');
            
            if(shareBtn) shareBtn.style.display = 'flex';
            if(warnMsg) warnMsg.style.display = 'none';
            if(fallbackInfo) fallbackInfo.style.display = 'none';

            const isFileProtocol = window.location.protocol === 'file:';
            if (isFileProtocol) {
                if(shareBtn) shareBtn.style.display = 'none';
                if(warnMsg) warnMsg.style.display = 'block';
            }

        } catch (e) {
            showLoading(false);
            showToast("Export Error: " + e.message, "error");
        }
    }, 500);
}

async function triggerSmartAction() {
    if(!currentExportFile) return;

    if (!navigator.canShare || !navigator.share || window.location.protocol === 'file:') {
        downloadDirectly();
        showToast("Sharing blocked by phone security. File Saved.", "info");
        return;
    }

    const shareData = {
        files: [currentExportFile],
        title: 'RBI Export',
        text: 'RBI Data File'
    };

    try {
        await navigator.share(shareData);
        closeShareModal();
        showToast("Shared Successfully!", "success");
    } catch (err) {
        console.log("Share failed/cancelled", err);
        if (err.name !== 'AbortError') {
            downloadDirectly();
            showToast("Sharing failed. Saving file instead.", "info");
        }
    }
}

function downloadDirectly() {
    if(!currentExportFile) return;
    const url = window.URL.createObjectURL(currentExportFile);
    const a = document.createElement("a");
    a.href = url;
    a.download = currentExportFile.name;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    closeShareModal();
}

function closeShareModal() {
    document.getElementById('share-modal').style.display = 'none';
}
</script>
</body>
</html>
